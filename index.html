<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 سیستم حساب داری</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <style>
        :root {
            --primary: #27ae60;
            --primary-dark: #219653;
            --secondary: #3498db;
            --danger: #e74c3c;
            --warning: #f39c12;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --success: #2ecc71;
            --purple: #9b59b6;
            --teal: #1abc9c;
            --gold: #f1c40f;
            --check-color: #9b59b6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 0;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.2);
        }

        .top-header {
            background: linear-gradient(135deg, var(--dark), #34495e);
            color: white;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo-icon {
            font-size: 1.3em;
        }

        .logo-text {
            font-size: 0.9em;
            font-weight: 800;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notification-bell {
            position: relative;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 5px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            text-decoration: none;
            color: white;
        }

        .notification-bell:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.2);
        }

        .notification-dot {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            background: var(--danger);
            border-radius: 50%;
            animation: pulse 2s infinite;
            border: 1px solid white;
        }

        .hamburger-menu {
            font-size: 1.3em;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .hamburger-menu:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.2);
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            width: 220px;
            z-index: 1001;
            display: none;
            overflow: hidden;
        }

        .dropdown-menu.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .dropdown-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark);
            font-weight: 600;
            font-size: 0.85em;
        }

        .dropdown-item:hover {
            background: #f5f5f5;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .media-slider {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            margin: 10px 0;
            border-radius: 10px;
            scrollbar-width: none;
        }

        .media-slider::-webkit-scrollbar {
            display: none;
        }

        .media-item {
            flex: 0 0 auto;
            width: 120px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .media-item img, .media-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .main-content {
            flex: 1;
            padding: 12px;
            overflow-y: auto;
            padding-bottom: 70px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .form-container {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
            position: relative;
            overflow: hidden;
        }

        .form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--purple));
        }

        .form-title {
            font-size: 1.1em;
            font-weight: 800;
            margin-bottom: 15px;
            color: var(--dark);
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .form-group {
            margin-bottom: 12px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 700;
            color: var(--dark);
            font-size: 0.8em;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 12px;
            transition: all 0.3s;
            background: #fafafa;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 2px rgba(39, 174, 96, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 800;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 3px 12px rgba(39, 174, 96, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.6);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
            box-shadow: 0 3px 12px rgba(52, 152, 219, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #e67e22);
            box-shadow: 0 3px 12px rgba(243, 156, 18, 0.4);
        }

        .btn-purple {
            background: linear-gradient(135deg, var(--purple), #8e44ad);
            box-shadow: 0 3px 12px rgba(155, 89, 182, 0.4);
        }

        .btn-check {
            background: linear-gradient(135deg, var(--check-color), #8e44ad);
            box-shadow: 0 3px 12px rgba(155, 89, 182, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            box-shadow: 0 3px 12px rgba(231, 76, 60, 0.4);
        }

        .success-message {
            background: var(--success);
            color: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            margin: 12px 0;
            font-weight: 700;
            box-shadow: 0 3px 12px rgba(46, 204, 113, 0.5);
            animation: slideIn 0.5s ease-out;
            font-size: 0.8em;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .production-result {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .production-title {
            font-size: 1em;
            font-weight: 800;
            margin-bottom: 12px;
            text-align: center;
        }

        .cost-breakdown {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px;
            border-radius: 10px;
            margin: 12px 0;
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        .cost-item:last-child {
            border-bottom: none;
        }

        .cost-label {
            font-weight: 700;
            font-size: 0.9em;
        }

        .cost-value {
            font-weight: 800;
            font-size: 1em;
        }

        .final-price-section {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            border: 2px solid white;
        }

        .price-label {
            font-size: 1em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .price-amount {
            font-size: 1.6em;
            font-weight: 900;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .advice-section {
            background: #e8f6ef;
            border: 2px solid var(--primary);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .advice-title {
            color: var(--dark);
            font-weight: 800;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .advice-content {
            color: #2c3e50;
            line-height: 1.5;
            font-size: 0.85em;
        }

        .chart-container {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
            margin: 15px 0;
            height: 250px;
        }

        .nav-bottom {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 8px 6px;
            box-shadow: 0 -3px 15px rgba(0, 0, 0, 0.1);
            border-top: 1px solid #e0e0e0;
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            padding: 6px 4px;
            border-radius: 10px;
            transition: all 0.3s;
            cursor: pointer;
            color: #7f8c8d;
            max-width: 70px;
            text-decoration: none;
        }

        .nav-item.active {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.15), rgba(52, 152, 219, 0.15));
            color: var(--primary);
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: 1.3em;
            margin-bottom: 3px;
        }

        .nav-label {
            font-size: 0.6em;
            font-weight: 700;
        }

        .transaction-list {
            margin-top: 15px;
        }

        .transaction-item {
            background: white;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-right: 3px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.3s;
        }

        .transaction-item:hover {
            transform: translateX(-2px);
        }

        .transaction-details {
            flex: 1;
        }

        .transaction-title {
            font-weight: 800;
            margin-bottom: 4px;
            color: var(--dark);
            font-size: 0.9em;
        }

        .transaction-meta {
            font-size: 0.7em;
            color: #7f8c8d;
        }

        .transaction-amount {
            font-weight: 800;
            font-size: 1em;
        }

        .income {
            color: var(--primary);
        }

        .expense {
            color: var(--danger);
        }

        .summary-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .summary-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s;
        }

        .summary-card:hover {
            transform: translateY(-2px);
        }

        .summary-card h3 {
            font-size: 0.75em;
            margin-bottom: 6px;
            color: #7f8c8d;
        }

        .summary-card .amount {
            font-size: 1.2em;
            font-weight: 800;
        }

        .cost-inputs {
            margin-bottom: 15px;
        }

        .cost-input-group {
            display: flex;
            gap: 6px;
            margin-bottom: 8px;
        }

        .cost-input-group input {
            flex: 1;
        }

        .add-cost-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.75em;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.3s;
        }

        .add-cost-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(52, 152, 219, 0.4);
        }

        .profit-display {
            background: linear-gradient(135deg, var(--gold), #f39c12);
            color: white;
            padding: 12px;
            border-radius: 10px;
            margin: 12px 0;
            text-align: center;
            box-shadow: 0 4px 12px rgba(243, 156, 18, 0.4);
        }

        .profit-title {
            font-size: 1em;
            font-weight: 800;
            margin-bottom: 6px;
        }

        .profit-amount {
            font-size: 1.5em;
            font-weight: 900;
        }

        .info-message {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 12px 0;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
            text-align: center;
            border: 1px solid white;
        }

        .info-title {
            font-size: 1em;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .info-content {
            font-size: 0.85em;
            line-height: 1.4;
            opacity: 0.95;
        }

        .accounting-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .accounting-stat {
            background: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .accounting-stat .value {
            font-size: 1.1em;
            font-weight: 800;
            margin: 5px 0;
        }

        .accounting-stat .label {
            font-size: 0.7em;
            color: #7f8c8d;
        }

        /* استایل‌های جدید برای بخش‌های اضافه شده */
        .signature-pad {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            margin-bottom: 12px;
            height: 150px;
            width: 100%;
        }

        .invoice-preview {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
        }

        .invoice-header {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .invoice-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .invoice-items {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        .invoice-items th, .invoice-items td {
            border: 1px solid #e0e0e0;
            padding: 8px;
            text-align: center;
        }

        .invoice-items th {
            background: #f5f5f5;
            font-weight: 700;
        }

        .invoice-total {
            text-align: left;
            font-weight: 800;
            font-size: 1.1em;
            margin-top: 10px;
        }

        .invoice-signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .signature-box {
            text-align: center;
            width: 45%;
        }

        .signature-line {
            border-top: 1px solid #333;
            margin-top: 40px;
            padding-top: 5px;
        }

        .assets-list {
            margin-top: 15px;
        }

        .asset-item {
            background: white;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-right: 3px solid var(--secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .asset-controls {
            display: flex;
            gap: 5px;
        }

        .asset-control-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7em;
        }

        .asset-control-btn.danger {
            background: var(--danger);
        }

        .employee-list {
            margin-top: 15px;
        }

        .employee-item {
            background: white;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border-right: 3px solid var(--purple);
        }

        .employee-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .employee-name {
            font-weight: 800;
            font-size: 1em;
        }

        .employee-salary {
            font-weight: 700;
            color: var(--success);
        }

        .employee-details {
            font-size: 0.8em;
            color: #7f8c8d;
            margin-bottom: 8px;
        }

        .employee-controls {
            display: flex;
            gap: 5px;
        }

        .card-number {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 1.1em;
            text-align: center;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .card-number:hover {
            background: #e0e0e0;
        }

        .help-content {
            line-height: 1.6;
            font-size: 0.9em;
        }

        .help-section {
            margin-bottom: 15px;
        }

        .help-title {
            font-weight: 800;
            margin-bottom: 8px;
            color: var(--dark);
            font-size: 1em;
        }

        @media (min-width: 768px) {
            .container {
                max-width: 800px;
                margin: 15px auto;
                min-height: calc(100vh - 30px);
                border-radius: 15px;
                overflow: hidden;
            }
            
            .nav-bottom {
                left: 50%;
                right: auto;
                width: 800px;
                transform: translateX(-50%);
                border-bottom-left-radius: 15px;
                border-bottom-right-radius: 15px;
            }
            
            .main-content {
                padding-bottom: 80px;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding-bottom: 70px;
            }
        }

        @media (max-width: 360px) {
            .top-header {
                padding: 8px 12px;
            }
            
            .logo-text {
                font-size: 0.8em;
            }
            
            .main-content {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-header">
            <div class="logo">
                <div class="logo-icon">🚀</div>
                <div class="logo-text">سیستم حساب داری</div>
            </div>
            <div class="header-controls">
                <div class="hamburger-menu" onclick="toggleMenu()">☰</div>
                <div class="dropdown-menu" id="dropdownMenu">
                    <div class="dropdown-item" onclick="showSection('employees')">
                        <span>👥</span> مدیریت کارمندان
                    </div>
                    <div class="dropdown-item" onclick="showSection('invoice')">
                        <span>🧾</span> ایجاد فاکتور
                    </div>
                    <div class="dropdown-item" onclick="showSection('assets')">
                        <span>💰</span> گاو صندوق / دارایی
                    </div>
                    <div class="dropdown-item" onclick="showSection('help')">
                        <span>❓</span> راهنمایی استفاده
                    </div>
                    <div class="dropdown-item" onclick="showSection('donate')">
                        <span>❤️</span> حمایت مالی
                    </div>
                </div>
                <a href="mk.html" class="notification-bell">
                    <div class="notification-dot"></div>
                    🔔
                </a>
            </div>
        </div>

        <!-- اسلایدر رسانه -->
        <div class="media-slider">
            <div class="media-item">
                <img src="m1.jpg" alt="تصویر تبلیغاتی" onerror="this.style.display='none'">
            </div>
            <div class="media-item">
                <video muted onloadedmetadata="this.muted=true" onerror="this.style.display='none'">
                    <source src="a.mp4" type="video/mp4">
                    مرورگر شما از ویدیو پشتیبانی نمی‌کند
                </video>
            </div>
            <div class="media-item">
                <img src="b.jpg" alt="بنر تبلیغاتی" onerror="this.style.display='none'">
            </div>
        </div>

        <div class="main-content">
            <!-- بخش مدیریت مالی -->
            <div id="finance" class="section active">
                <div class="form-container">
                    <h2 class="form-title">💰 مدیریت مالی</h2>
                    
                    <div class="form-group">
                        <label for="finance-type">نوع تراکنش:</label>
                        <select id="finance-type">
                            <option value="income">درآمد</option>
                            <option value="expense">هزینه</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="finance-amount">مبلغ (تومان):</label>
                        <input type="number" id="finance-amount" placeholder="مبلغ را وارد کنید">
                    </div>

                    <div class="form-group">
                        <label for="finance-description">توضیحات:</label>
                        <input type="text" id="finance-description" placeholder="شرح تراکنش">
                    </div>

                    <div class="form-group">
                        <label for="finance-category">دسته‌بندی:</label>
                        <select id="finance-category">
                            <option value="salary">حقوق</option>
                            <option value="business">کسب و کار</option>
                            <option value="investment">سرمایه‌گذاری</option>
                            <option value="food">خوراکی</option>
                            <option value="transport">حمل و نقل</option>
                            <option value="shopping">خرید</option>
                            <option value="bills">قبض</option>
                            <option value="entertainment">سرگرمی</option>
                            <option value="health">سلامت</option>
                            <option value="other">متفرقه</option>
                        </select>
                    </div>

                    <button class="btn" onclick="addFinanceTransaction()">
                        <span>💾</span> ثبت تراکنش
                    </button>
                </div>

                <div class="form-container">
                    <h2 class="form-title">📊 نمودار مالی</h2>
                    <div class="chart-container">
                        <canvas id="financeChart"></canvas>
                    </div>
                </div>

                <div class="transaction-list" id="finance-transactions">
                    <!-- تراکنش‌ها اینجا نمایش داده می‌شوند -->
                </div>
            </div>

            <!-- بخش حسابرسی تولیدی -->
            <div id="production" class="section">
                <div class="form-container">
                    <h2 class="form-title">🏭 حسابرسی تولیدی</h2>
                    
                    <div class="form-group">
                        <label for="product-name">نام محصول:</label>
                        <input type="text" id="product-name" placeholder="نام محصول را وارد کنید">
                    </div>

                    <div class="form-group">
                        <label for="material-cost">هزینه کل مواد اولیه (تومان):</label>
                        <input type="number" id="material-cost" placeholder="مثلاً 50000000 برای 50 میلیون">
                    </div>

                    <div class="form-group">
                        <label for="production-quantity">تعداد تولید شده:</label>
                        <input type="number" id="production-quantity" placeholder="تعداد تولید شده">
                    </div>

                    <div class="cost-inputs">
                        <h3 style="margin-bottom: 12px; color: var(--dark); font-weight: 800;">💰 هزینه‌های اضافی تولید:</h3>
                        <div id="additional-costs">
                            <!-- هزینه‌های اضافی اینجا اضافه می‌شوند -->
                        </div>
                        <button type="button" class="add-cost-btn" onclick="addCostField()">
                            <span>➕</span> افزودن هزینه جدید
                        </button>
                    </div>

                    <div class="form-group">
                        <label for="desired-profit">سود مورد نظر شما (درصد):</label>
                        <input type="number" id="desired-profit" placeholder="مثلاً 30 برای 30% سود">
                    </div>

                    <button class="btn btn-purple" onclick="calculateProductionCost()">
                        <span>🧮</span> محاسبه دقیق قیمت تمام شده
                    </button>
                </div>

                <div id="production-result">
                    <!-- نتایج محاسبات اینجا نمایش داده می‌شوند -->
                </div>
            </div>

            <!-- بخش حسابداری -->
            <div id="accounting" class="section">
                <div class="form-container">
                    <h2 class="form-title">📊 گزارش‌های حسابداری</h2>
                    <div class="info-message">
                        <div class="info-title">💰 خلاصه عملکرد مالی</div>
                        <div class="info-content">
                            در این بخش می‌توانید عملکرد مالی کامل خود را مشاهده کنید.
                        </div>
                    </div>
                    
                    <div class="accounting-stats">
                        <div class="accounting-stat">
                            <div class="label">کل درآمد</div>
                            <div class="value income" id="accounting-total-income">۰ تومان</div>
                        </div>
                        <div class="accounting-stat">
                            <div class="label">کل هزینه</div>
                            <div class="value expense" id="accounting-total-expense">۰ تومان</div>
                        </div>
                        <div class="accounting-stat">
                            <div class="label">سود خالص</div>
                            <div class="value" id="accounting-net-profit">۰ تومان</div>
                        </div>
                        <div class="accounting-stat">
                            <div class="label">چک‌های فعال</div>
                            <div class="value" id="accounting-active-checks">۰</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="accountingChart"></canvas>
                    </div>

                    <div style="margin-top: 15px; display: flex; gap: 8px;">
                        <button class="btn btn-secondary" onclick="generateFinancialReport()">
                            <span>📄</span> گزارش کامل
                        </button>
                        <button class="btn btn-warning" onclick="showFinancialTips()">
                            <span>💡</span> نکات مالی
                        </button>
                    </div>
                </div>
            </div>

            <!-- بخش مدیریت چک -->
            <div id="checks" class="section">
                <div class="form-container">
                    <h2 class="form-title">🏦 سیستم مدیریت چک</h2>
                    
                    <div class="form-group">
                        <label for="check-amount">مبلغ چک (تومان):</label>
                        <input type="number" id="check-amount" placeholder="مبلغ چک را وارد کنید">
                    </div>

                    <div class="form-group">
                        <label for="check-bank">نام بانک:</label>
                        <input type="text" id="check-bank" placeholder="نام بانک صادر کننده">
                    </div>

                    <div class="form-group">
                        <label for="check-issuer">صادر کننده چک:</label>
                        <input type="text" id="check-issuer" placeholder="نام صادر کننده چک">
                    </div>

                    <div class="form-group">
                        <label for="check-due-date">تاریخ سررسید:</label>
                        <input type="date" id="check-due-date">
                    </div>

                    <button class="btn btn-check" onclick="addCheck()">
                        <span>💾</span> ثبت چک جدید
                    </button>
                </div>

                <div class="form-container">
                    <h2 class="form-title">📋 چک‌های ثبت شده</h2>
                    <div id="checks-list">
                        <!-- لیست چک‌ها اینجا نمایش داده می‌شود -->
                    </div>
                </div>
            </div>

            <!-- بخش مدیریت کارمندان -->
            <div id="employees" class="section">
                <div class="form-container">
                    <h2 class="form-title">👥 مدیریت کارمندان</h2>
                    
                    <div class="form-group">
                        <label for="employee-name">نام کارمند:</label>
                        <input type="text" id="employee-name" placeholder="نام کامل کارمند">
                    </div>

                    <div class="form-group">
                        <label for="employee-position">سمت:</label>
                        <input type="text" id="employee-position" placeholder="سمت شغلی">
                    </div>

                    <div class="form-group">
                        <label for="employee-salary">حقوق ماهانه (تومان):</label>
                        <input type="number" id="employee-salary" placeholder="مبلغ حقوق">
                    </div>

                    <div class="form-group">
                        <label for="employee-start-date">تاریخ شروع به کار:</label>
                        <input type="date" id="employee-start-date">
                    </div>

                    <div class="form-group">
                        <label for="employee-performance">عملکرد (از 10):</label>
                        <input type="number" id="employee-performance" min="0" max="10" placeholder="امتیاز عملکرد">
                    </div>

                    <button class="btn" onclick="addEmployee()">
                        <span>➕</span> افزودن کارمند
                    </button>
                </div>

                <div class="form-container">
                    <h2 class="form-title">📋 لیست کارمندان</h2>
                    <div class="employee-list" id="employees-list">
                        <!-- لیست کارمندان اینجا نمایش داده می‌شود -->
                    </div>
                </div>
            </div>

            <!-- بخش ایجاد فاکتور -->
            <div id="invoice" class="section">
                <div class="form-container">
                    <h2 class="form-title">🧾 ایجاد فاکتور</h2>
                    
                    <div class="form-group">
                        <label for="invoice-type">نوع فاکتور:</label>
                        <select id="invoice-type">
                            <option value="sale">فروش</option>
                            <option value="purchase">خرید</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="invoice-seller">فروشنده:</label>
                        <input type="text" id="invoice-seller" placeholder="نام فروشنده">
                    </div>

                    <div class="form-group">
                        <label for="invoice-buyer">خریدار:</label>
                        <input type="text" id="invoice-buyer" placeholder="نام خریدار">
                    </div>

                    <div class="form-group">
                        <label for="invoice-date">تاریخ:</label>
                        <input type="date" id="invoice-date">
                    </div>

                    <h3 style="margin: 15px 0 10px; color: var(--dark);">🛍️ اقلام فاکتور</h3>
                    <div id="invoice-items">
                        <div class="invoice-item-row">
                            <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                <input type="text" placeholder="نام کالا" class="item-name">
                                <input type="number" placeholder="تعداد" class="item-quantity" style="width: 80px;">
                                <input type="number" placeholder="قیمت واحد" class="item-price" style="width: 120px;">
                                <button type="button" class="add-cost-btn danger" onclick="removeInvoiceItem(this)">✕</button>
                            </div>
                        </div>
                    </div>
                    <button type="button" class="add-cost-btn" onclick="addInvoiceItem()">
                        <span>➕</span> افزودن کالا
                    </button>

                    <div class="form-group" style="margin-top: 15px;">
                        <label for="invoice-notes">توضیحات:</label>
                        <textarea id="invoice-notes" rows="3" placeholder="توضیحات اضافی"></textarea>
                    </div>

                    <h3 style="margin: 15px 0 10px; color: var(--dark);">✍️ امضا</h3>
                    <div class="signature-pad-container">
                        <canvas class="signature-pad" id="signature-pad"></canvas>
                        <button type="button" class="add-cost-btn danger" onclick="clearSignature()" style="margin-bottom: 10px;">
                            <span>🗑️</span> پاک کردن امضا
                        </button>
                    </div>

                    <button class="btn btn-purple" onclick="generateInvoice()">
                        <span>🧾</span> ایجاد فاکتور
                    </button>
                </div>

                <div class="invoice-preview" id="invoice-preview" style="display: none;">
                    <!-- پیش‌نمایش فاکتور اینجا نمایش داده می‌شود -->
                </div>
            </div>

            <!-- بخش گاو صندوق / دارایی -->
            <div id="assets" class="section">
                <div class="form-container">
                    <h2 class="form-title">💰 مدیریت دارایی‌ها</h2>
                    
                    <div class="form-group">
                        <label for="asset-name">نام دارایی:</label>
                        <input type="text" id="asset-name" placeholder="نام دارایی (مثلاً: پول نقد، طلا، سهام)">
                    </div>

                    <div class="form-group">
                        <label for="asset-value">ارزش (تومان):</label>
                        <input type="number" id="asset-value" placeholder="ارزش دارایی">
                    </div>

                    <div class="form-group">
                        <label for="asset-quantity">تعداد/مقدار:</label>
                        <input type="number" id="asset-quantity" placeholder="تعداد یا مقدار" value="1">
                    </div>

                    <div class="form-group">
                        <label for="asset-description">توضیحات:</label>
                        <textarea id="asset-description" rows="2" placeholder="توضیحات درباره دارایی"></textarea>
                    </div>

                    <button class="btn" onclick="addAsset()">
                        <span>➕</span> افزودن دارایی
                    </button>
                </div>

                <div class="form-container">
                    <h2 class="form-title">📊 دارایی‌های شما</h2>
                    <div class="assets-list" id="assets-list">
                        <!-- لیست دارایی‌ها اینجا نمایش داده می‌شود -->
                    </div>
                    <div class="profit-display" id="total-assets">
                        <div class="profit-title">💰 کل دارایی‌های شما</div>
                        <div class="profit-amount">۰ تومان</div>
                    </div>
                </div>
            </div>

            <!-- بخش راهنمایی استفاده -->
            <div id="help" class="section">
                <div class="form-container">
                    <h2 class="form-title">❓ راهنمایی استفاده از پلتفرم</h2>
                    
                    <div class="help-content">
                        <div class="help-section">
                            <div class="help-title">🎯 هدف پلتفرم</div>
                            <p>این پلتفرم یک سیستم جامع مدیریت مالی و حسابداری است که به شما کمک می‌کند تمام امور مالی کسب و کار خود را به صورت حرفه‌ای مدیریت کنید.</p>
                        </div>

                        <div class="help-section">
                            <div class="help-title">📊 بخش‌های اصلی</div>
                            <ul style="padding-right: 20px; margin-top: 8px;">
                                <li><strong>مدیریت مالی:</strong> ثبت درآمدها و هزینه‌ها</li>
                                <li><strong>حسابرسی تولیدی:</strong> محاسبه قیمت تمام شده محصولات</li>
                                <li><strong>گزارش‌های حسابداری:</strong> تحلیل و گزارش‌گیری مالی</li>
                                <li><strong>مدیریت چک:</strong> پیگیری چک‌های دریافتی و پرداختی</li>
                                <li><strong>مدیریت کارمندان:</strong> ثبت اطلاعات و حقوق پرسنل</li>
                                <li><strong>ایجاد فاکتور:</strong> صدور فاکتورهای فروش و خرید</li>
                                <li><strong>مدیریت دارایی:</strong> ثبت و پیگیری دارایی‌های شما</li>
                            </ul>
                        </div>

                        <div class="help-section">
                            <div class="help-title">💡 نکات مهم</div>
                            <ul style="padding-right: 20px; margin-top: 8px;">
                                <li>اطلاعات خود را به طور منظم ثبت کنید</li>
                                <li>از گزارش‌های مالی برای تحلیل عملکرد استفاده کنید</li>
                                <li>هشدارها و یادآوری‌ها را فعال نگه دارید</li>
                                <li>اطلاعات مهم را پشتیبان‌گیری کنید</li>
                            </ul>
                        </div>

                        <div class="help-section">
                            <div class="help-title">📱 نحوه استفاده</div>
                            <p>برای استفاده از هر بخش، از منوی بالا یا نوار پایین صفحه بخش مورد نظر را انتخاب کنید. سپس اطلاعات خواسته شده را وارد کرده و عملیات مورد نظر را انجام دهید.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- بخش حمایت مالی -->
            <div id="donate" class="section">
                <div class="form-container">
                    <h2 class="form-title">❤️ حمایت مالی</h2>
                    
                    <div class="info-message">
                        <div class="info-title">🙏 قدردانی از حمایت شما</div>
                        <div class="info-content">
                            این پلتفرم با هدف کمک به کسب و کارهای کوچک و متوسط توسعه یافته است. 
                            حمایت‌های مالی داوطلبانه شما به ما انگیزه می‌دهد تا به توسعه و بهبود این سیستم ادامه دهیم.
                        </div>
                    </div>

                    <div class="form-group">
                        <label>شماره کارت برای حمایت مالی:</label>
                        <div class="card-number" onclick="copyCardNumber()">
                            5892101187322777
                        </div>
                        <div style="text-align: center; font-size: 0.8em; color: #7f8c8d; margin-top: 5px;">
                            برای کپی کردن کلیک کنید
                        </div>
                    </div>

                    <div class="advice-section">
                        <div class="advice-title">💳 نحوه واریز</div>
                        <div class="advice-content">
                            <p>می‌توانید از طریق تمامی دستگاه‌های خودپرداز، اینترنت بانک یا برنامه‌های موبایلی بانک‌ها مبلغ مورد نظر خود را به شماره کارت بالا واریز کنید.</p>
                            <p style="margin-top: 8px;">هر میزان حمایت مالی شما، حتی مبالغ کوچک، برای ما بسیار ارزشمند است و در توسعه و بهبود این پلتفرم سرمایه‌گذاری خواهد شد.</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="donation-amount">مبلغ حمایت (تومان):</label>
                        <input type="number" id="donation-amount" placeholder="مبلغ مورد نظر برای حمایت">
                    </div>

                    <div class="form-group">
                        <label for="donation-message">پیام حمایتی (اختیاری):</label>
                        <textarea id="donation-message" rows="3" placeholder="پیام حمایتی خود را اینجا بنویسید..."></textarea>
                    </div>

                    <button class="btn btn-purple" onclick="submitDonation()">
                        <span>💳</span> ثبت حمایت مالی
                    </button>
                </div>
            </div>
        </div>

        <!-- ناوبری پایین -->
        <div class="nav-bottom">
            <div class="nav-item active" onclick="showSection('finance')">
                <div class="nav-icon">💰</div>
                <div class="nav-label">مالی</div>
            </div>
            <div class="nav-item" onclick="showSection('production')">
                <div class="nav-icon">🏭</div>
                <div class="nav-label">تولیدی</div>
            </div>
            <div class="nav-item" onclick="showSection('accounting')">
                <div class="nav-icon">📊</div>
                <div class="nav-label">حسابداری</div>
            </div>
            <div class="nav-item" onclick="showSection('checks')">
                <div class="nav-icon">🏦</div>
                <div class="nav-label">چک‌ها</div>
            </div>
        </div>
    </div>

    <script>
        // داده‌های خالی
        let financeData = {
            income: 0,
            expense: 0,
            transactions: []
        };

        let productionData = {
            costs: [],
            products: []
        };

        let accountingData = {
            totalIncome: 0,
            totalExpense: 0,
            netProfit: 0,
            activeChecks: 0
        };

        let checksData = [];
        let employeesData = [];
        let assetsData = [];
        let invoicesData = [];

        // امضای دیجیتال
        let signaturePad = null;

        // تاریخ شمسی
        function getCurrentPersianDate() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return now.toLocaleDateString('fa-IR', options);
        }

        // نمایش بخش مورد نظر
        function showSection(sectionId) {
            // مخفی کردن تمام بخش‌ها
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // نمایش بخش انتخاب شده
            document.getElementById(sectionId).classList.add('active');
            
            // به‌روزرسانی ناوبری پایین
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // مخفی کردن منوی کشویی
            document.getElementById('dropdownMenu').classList.remove('active');
            
            // اگر بخش امضا فعال است، امضای دیجیتال را راه‌اندازی کن
            if (sectionId === 'invoice' && !signaturePad) {
                setTimeout(() => {
                    const canvas = document.getElementById('signature-pad');
                    if (canvas) {
                        signaturePad = new SignaturePad(canvas);
                        canvas.style.width = '100%';
                        canvas.style.height = '150px';
                    }
                }, 100);
            }
            
            // اگر بخش مالی است، نمودار را به‌روزرسانی کن
            if (sectionId === 'finance') {
                updateFinanceChart();
            }
            
            // اگر بخش حسابداری است، نمودار حسابداری را به‌روزرسانی کن
            if (sectionId === 'accounting') {
                updateAccountingChart();
            }
        }

        // نمایش/مخفی کردن منوی کشویی
        function toggleMenu() {
            const menu = document.getElementById('dropdownMenu');
            menu.classList.toggle('active');
        }

        // بستن منوی کشویی هنگام کلیک خارج از آن
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('dropdownMenu');
            const hamburger = document.querySelector('.hamburger-menu');
            
            if (!menu.contains(event.target) && !hamburger.contains(event.target)) {
                menu.classList.remove('active');
            }
        });

        // افزودن تراکنش مالی
        function addFinanceTransaction() {
            const type = document.getElementById('finance-type').value;
            const amount = parseInt(document.getElementById('finance-amount').value) || 0;
            const description = document.getElementById('finance-description').value || 'بدون توضیح';
            const category = document.getElementById('finance-category').value;
            
            if (amount <= 0) {
                alert('لطفاً مبلغ معتبر وارد کنید');
                return;
            }
            
            const transaction = {
                id: Date.now(),
                type,
                amount,
                description,
                category,
                date: new Date().toLocaleDateString('fa-IR')
            };
            
            financeData.transactions.push(transaction);
            
            if (type === 'income') {
                financeData.income += amount;
            } else {
                financeData.expense += amount;
            }
            
            updateFinanceDisplay();
            document.getElementById('finance-amount').value = '';
            document.getElementById('finance-description').value = '';
            
            // نمایش پیام موفقیت
            showSuccessMessage('تراکنش با موفقیت ثبت شد');
        }

        // به‌روزرسانی نمایش مالی
        function updateFinanceDisplay() {
            const transactionsContainer = document.getElementById('finance-transactions');
            transactionsContainer.innerHTML = '';
            
            if (financeData.transactions.length === 0) {
                transactionsContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #7f8c8d;">هیچ تراکنشی ثبت نشده است</div>';
                return;
            }
            
            financeData.transactions.forEach(transaction => {
                const transactionElement = document.createElement('div');
                transactionElement.className = 'transaction-item';
                transactionElement.innerHTML = `
                    <div class="transaction-details">
                        <div class="transaction-title">${transaction.description}</div>
                        <div class="transaction-meta">${transaction.date} - ${getCategoryName(transaction.category)}</div>
                    </div>
                    <div class="transaction-amount ${transaction.type === 'income' ? 'income' : 'expense'}">
                        ${transaction.type === 'income' ? '+' : '-'} ${transaction.amount.toLocaleString()} تومان
                    </div>
                `;
                transactionsContainer.appendChild(transactionElement);
            });
            
            updateFinanceChart();
        }

        // دریافت نام دسته‌بندی
        function getCategoryName(category) {
            const categories = {
                salary: 'حقوق',
                business: 'کسب و کار',
                investment: 'سرمایه‌گذاری',
                food: 'خوراکی',
                transport: 'حمل و نقل',
                shopping: 'خرید',
                bills: 'قبض',
                entertainment: 'سرگرمی',
                health: 'سلامت',
                other: 'متفرقه'
            };
            
            return categories[category] || 'سایر';
        }

        // به‌روزرسانی نمودار مالی
        function updateFinanceChart() {
            const ctx = document.getElementById('financeChart').getContext('2d');
            
            // داده‌های نمودار
            const incomeData = financeData.transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const expenseData = financeData.transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
            
            // اگر نمودار قبلی وجود دارد، آن را از بین ببر
            if (window.financeChartInstance) {
                window.financeChartInstance.destroy();
            }
            
            // اگر داده‌ای وجود ندارد، پیام نشان بده
            if (incomeData === 0 && expenseData === 0) {
                document.getElementById('financeChart').style.display = 'none';
                return;
            }
            
            document.getElementById('financeChart').style.display = 'block';
            
            // ایجاد نمودار جدید
            window.financeChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['درآمد', 'هزینه'],
                    datasets: [{
                        data: [incomeData, expenseData],
                        backgroundColor: ['#27ae60', '#e74c3c'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            rtl: true,
                            labels: {
                                font: {
                                    family: 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif'
                                }
                            }
                        }
                    }
                }
            });
        }

        // افزودن فیلد هزینه
        function addCostField() {
            const costsContainer = document.getElementById('additional-costs');
            const costId = 'cost-' + Date.now();
            
            const costElement = document.createElement('div');
            costElement.className = 'cost-input-group';
            costElement.innerHTML = `
                <input type="text" placeholder="عنوان هزینه (مثلاً: دستمزد کارگر)" id="${costId}-name">
                <input type="number" placeholder="مبلغ (تومان)" id="${costId}-amount">
                <button type="button" class="add-cost-btn danger" onclick="this.parentElement.remove()">✕</button>
            `;
            
            costsContainer.appendChild(costElement);
        }

        // محاسبه هزینه تولید
        function calculateProductionCost() {
            const productName = document.getElementById('product-name').value || 'محصول';
            const materialCost = parseInt(document.getElementById('material-cost').value) || 0;
            const quantity = parseInt(document.getElementById('production-quantity').value) || 1;
            const desiredProfit = parseInt(document.getElementById('desired-profit').value) || 0;
            
            if (materialCost <= 0 || quantity <= 0) {
                alert('لطفاً مقادیر معتبر وارد کنید');
                return;
            }
            
            // محاسبه هزینه‌های اضافی
            let additionalCosts = 0;
            const costInputs = document.querySelectorAll('#additional-costs .cost-input-group');
            costInputs.forEach(input => {
                const amount = parseInt(input.querySelector('input[type="number"]').value) || 0;
                additionalCosts += amount;
            });
            
            // محاسبه قیمت تمام شده
            const totalCost = materialCost + additionalCosts;
            const costPerUnit = totalCost / quantity;
            const profitPerUnit = costPerUnit * (desiredProfit / 100);
            const sellingPricePerUnit = costPerUnit + profitPerUnit;
            const totalSellingPrice = sellingPricePerUnit * quantity;
            const totalProfit = totalSellingPrice - totalCost;
            
            // نمایش نتایج
            const resultContainer = document.getElementById('production-result');
            resultContainer.innerHTML = `
                <div class="production-result">
                    <div class="production-title">🧮 نتایج محاسبات برای "${productName}"</div>
                    
                    <div class="cost-breakdown">
                        <div class="cost-item">
                            <span class="cost-label">هزینه مواد اولیه:</span>
                            <span class="cost-value">${materialCost.toLocaleString()} تومان</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">هزینه‌های اضافی:</span>
                            <span class="cost-value">${additionalCosts.toLocaleString()} تومان</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">هزینه کل تولید:</span>
                            <span class="cost-value">${totalCost.toLocaleString()} تومان</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">تعداد تولید شده:</span>
                            <span class="cost-value">${quantity.toLocaleString()} عدد</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">قیمت تمام شده هر واحد:</span>
                            <span class="cost-value">${Math.round(costPerUnit).toLocaleString()} تومان</span>
                        </div>
                    </div>
                    
                    <div class="final-price-section">
                        <div class="price-label">💰 قیمت فروش هر واحد (با ${desiredProfit}% سود):</div>
                        <div class="price-amount">${Math.round(sellingPricePerUnit).toLocaleString()} تومان</div>
                    </div>
                    
                    <div class="profit-display">
                        <div class="profit-title">💵 سود کل پیش‌بینی شده</div>
                        <div class="profit-amount">${Math.round(totalProfit).toLocaleString()} تومان</div>
                    </div>
                </div>
                
                <div class="advice-section">
                    <div class="advice-title">💡 توصیه‌های مالی</div>
                    <div class="advice-content">
                        <p>• برای افزایش سود، راه‌های کاهش هزینه‌های تولید را بررسی کنید</p>
                        <p>• قیمت‌های بازار را برای محصول مشابه بررسی کنید</p>
                        <p>• در صورت امکان، حجم تولید را افزایش دهید تا هزینه واحد کاهش یابد</p>
                    </div>
                </div>
            `;
            
            // ذخیره داده‌های تولید
            productionData.products.push({
                name: productName,
                materialCost,
                additionalCosts,
                quantity,
                sellingPrice: Math.round(sellingPricePerUnit),
                profit: Math.round(totalProfit),
                date: new Date().toLocaleDateString('fa-IR')
            });
            
            showSuccessMessage('محاسبات با موفقیت انجام شد');
        }

        // افزودن چک
        function addCheck() {
            const amount = parseInt(document.getElementById('check-amount').value) || 0;
            const bank = document.getElementById('check-bank').value || 'نامشخص';
            const issuer = document.getElementById('check-issuer').value || 'نامشخص';
            const dueDate = document.getElementById('check-due-date').value;
            
            if (amount <= 0 || !dueDate) {
                alert('لطفاً اطلاعات ضروری را وارد کنید');
                return;
            }
            
            const check = {
                id: Date.now(),
                amount,
                bank,
                issuer,
                dueDate,
                status: 'active',
                date: new Date().toLocaleDateString('fa-IR')
            };
            
            checksData.push(check);
            updateChecksDisplay();
            
            document.getElementById('check-amount').value = '';
            document.getElementById('check-bank').value = '';
            document.getElementById('check-issuer').value = '';
            document.getElementById('check-due-date').value = '';
            
            showSuccessMessage('چک با موفقیت ثبت شد');
        }

        // به‌روزرسانی نمایش چک‌ها
        function updateChecksDisplay() {
            const checksContainer = document.getElementById('checks-list');
            checksContainer.innerHTML = '';
            
            if (checksData.length === 0) {
                checksContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #7f8c8d;">چکی ثبت نشده است</div>';
                return;
            }
            
            checksData.forEach(check => {
                const checkElement = document.createElement('div');
                checkElement.className = 'transaction-item';
                checkElement.innerHTML = `
                    <div class="transaction-details">
                        <div class="transaction-title">چک ${check.bank} - ${check.issuer}</div>
                        <div class="transaction-meta">سررسید: ${check.dueDate} - وضعیت: ${check.status === 'active' ? 'فعال' : 'وصول شده'}</div>
                    </div>
                    <div class="transaction-amount ${check.status === 'active' ? 'income' : 'expense'}">
                        ${check.amount.toLocaleString()} تومان
                    </div>
                `;
                checksContainer.appendChild(checkElement);
            });
            
            // به‌روزرسانی آمار حسابداری
            accountingData.activeChecks = checksData.filter(c => c.status === 'active').length;
            updateAccountingDisplay();
        }

        // به‌روزرسانی نمایش حسابداری
        function updateAccountingDisplay() {
            document.getElementById('accounting-total-income').textContent = `${financeData.income.toLocaleString()} تومان`;
            document.getElementById('accounting-total-expense').textContent = `${financeData.expense.toLocaleString()} تومان`;
            document.getElementById('accounting-net-profit').textContent = `${(financeData.income - financeData.expense).toLocaleString()} تومان`;
            document.getElementById('accounting-active-checks').textContent = accountingData.activeChecks;
        }

        // به‌روزرسانی نمودار حسابداری
        function updateAccountingChart() {
            const ctx = document.getElementById('accountingChart').getContext('2d');
            
            // داده‌های نمودار
            const incomeData = financeData.income;
            const expenseData = financeData.expense;
            const netProfit = incomeData - expenseData;
            
            // اگر نمودار قبلی وجود دارد، آن را از بین ببر
            if (window.accountingChartInstance) {
                window.accountingChartInstance.destroy();
            }
            
            // اگر داده‌ای وجود ندارد، پیام نشان بده
            if (incomeData === 0 && expenseData === 0) {
                document.getElementById('accountingChart').style.display = 'none';
                return;
            }
            
            document.getElementById('accountingChart').style.display = 'block';
            
            // ایجاد نمودار جدید
            window.accountingChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['درآمد', 'هزینه', 'سود خالص'],
                    datasets: [{
                        label: 'مبلغ (تومان)',
                        data: [incomeData, expenseData, netProfit],
                        backgroundColor: ['#27ae60', '#e74c3c', '#3498db'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + ' تومان';
                                }
                            }
                        }
                    }
                }
            });
        }

        // تولید گزارش مالی
        function generateFinancialReport() {
            const report = `
                گزارش مالی کامل - ${getCurrentPersianDate()}
                
                📊 خلاصه عملکرد:
                • کل درآمد: ${financeData.income.toLocaleString()} تومان
                • کل هزینه: ${financeData.expense.toLocaleString()} تومان
                • سود خالص: ${(financeData.income - financeData.expense).toLocaleString()} تومان
                • تعداد چک‌های فعال: ${accountingData.activeChecks}
                
                💼 تراکنش‌ها:
                ${financeData.transactions.length > 0 ? 
                    financeData.transactions.map(t => 
                        `• ${t.date} - ${t.description} - ${t.type === 'income' ? '+' : '-'}${t.amount.toLocaleString()} تومان`
                    ).join('\n') 
                    : '• هیچ تراکنشی ثبت نشده است'
                }
                
                🏭 محصولات تولیدی:
                ${productionData.products.length > 0 ? 
                    productionData.products.map(p => 
                        `• ${p.name} - قیمت فروش: ${p.sellingPrice.toLocaleString()} تومان - سود: ${p.profit.toLocaleString()} تومان`
                    ).join('\n') 
                    : '• هیچ محصولی ثبت نشده است'
                }
            `;
            
            alert(report);
            showSuccessMessage('گزارش مالی ایجاد شد');
        }

        // نمایش نکات مالی
        function showFinancialTips() {
            const tips = [
                "💡 همیشه 10-20% از درآمد خود را پس‌انداز کنید",
                "💡 هزینه‌های خود را به طور منظم بررسی و تحلیل کنید",
                "💡 برای سرمایه‌گذاری‌های بزرگ تحقیق کنید",
                "💡 از وام‌های با بهره بالا خودداری کنید",
                "💡 برای دوران بازنشستگی برنامه‌ریزی کنید",
                "💡 بیمه مناسب برای دارایی‌های خود تهیه کنید",
                "💡 صورت‌های مالی خود را به طور منظم بررسی کنید"
            ];
            
            alert("نکات مالی مهم:\n\n" + tips.join('\n'));
        }

        // نمایش پیام موفقیت
        function showSuccessMessage(message) {
            // حذف پیام قبلی اگر وجود دارد
            const existingMessage = document.querySelector('.success-message');
            if (existingMessage) {
                existingMessage.remove();
            }
            
            // ایجاد پیام جدید
            const messageElement = document.createElement('div');
            messageElement.className = 'success-message';
            messageElement.textContent = message;
            
            // اضافه کردن پیام به بالای محتوا
            const mainContent = document.querySelector('.main-content');
            mainContent.prepend(messageElement);
            
            // حذف خودکار پیام بعد از 3 ثانیه
            setTimeout(() => {
                messageElement.remove();
            }, 3000);
        }

        // افزودن کارمند
        function addEmployee() {
            const name = document.getElementById('employee-name').value;
            const position = document.getElementById('employee-position').value;
            const salary = parseInt(document.getElementById('employee-salary').value) || 0;
            const startDate = document.getElementById('employee-start-date').value;
            const performance = parseInt(document.getElementById('employee-performance').value) || 0;
            
            if (!name || !position || salary <= 0 || !startDate) {
                alert('لطفاً اطلاعات ضروری را وارد کنید');
                return;
            }
            
            const employee = {
                id: Date.now(),
                name,
                position,
                salary,
                startDate,
                performance,
                status: 'active'
            };
            
            employeesData.push(employee);
            updateEmployeesDisplay();
            
            // پاک کردن فرم
            document.getElementById('employee-name').value = '';
            document.getElementById('employee-position').value = '';
            document.getElementById('employee-salary').value = '';
            document.getElementById('employee-start-date').value = '';
            document.getElementById('employee-performance').value = '';
            
            showSuccessMessage('کارمند با موفقیت اضافه شد');
        }

        // به‌روزرسانی نمایش کارمندان
        function updateEmployeesDisplay() {
            const employeesContainer = document.getElementById('employees-list');
            employeesContainer.innerHTML = '';
            
            if (employeesData.length === 0) {
                employeesContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #7f8c8d;">هیچ کارمندی ثبت نشده است</div>';
                return;
            }
            
            employeesData.forEach(employee => {
                const employeeElement = document.createElement('div');
                employeeElement.className = 'employee-item';
                employeeElement.innerHTML = `
                    <div class="employee-header">
                        <div class="employee-name">${employee.name}</div>
                        <div class="employee-salary">${employee.salary.toLocaleString()} تومان</div>
                    </div>
                    <div class="employee-details">
                        <div>سمت: ${employee.position}</div>
                        <div>تاریخ شروع: ${employee.startDate}</div>
                        <div>عملکرد: ${employee.performance}/10</div>
                    </div>
                    <div class="employee-controls">
                        <button class="asset-control-btn" onclick="editEmployee(${employee.id})">✏️ ویرایش</button>
                        <button class="asset-control-btn danger" onclick="removeEmployee(${employee.id})">🗑️ حذف</button>
                    </div>
                `;
                employeesContainer.appendChild(employeeElement);
            });
        }

        // حذف کارمند
        function removeEmployee(id) {
            if (confirm('آیا از حذف این کارمند اطمینان دارید؟')) {
                employeesData = employeesData.filter(employee => employee.id !== id);
                updateEmployeesDisplay();
                showSuccessMessage('کارمند با موفقیت حذف شد');
            }
        }

        // ویرایش کارمند
        function editEmployee(id) {
            const employee = employeesData.find(emp => emp.id === id);
            if (employee) {
                document.getElementById('employee-name').value = employee.name;
                document.getElementById('employee-position').value = employee.position;
                document.getElementById('employee-salary').value = employee.salary;
                document.getElementById('employee-start-date').value = employee.startDate;
                document.getElementById('employee-performance').value = employee.performance;
                
                // حذف کارمند قدیمی
                employeesData = employeesData.filter(emp => emp.id !== id);
                updateEmployeesDisplay();
                
                showSuccessMessage('اطلاعات کارمند برای ویرایش بارگذاری شد');
            }
        }

        // افزودن دارایی
        function addAsset() {
            const name = document.getElementById('asset-name').value;
            const value = parseInt(document.getElementById('asset-value').value) || 0;
            const quantity = parseInt(document.getElementById('asset-quantity').value) || 1;
            const description = document.getElementById('asset-description').value || 'بدون توضیح';
            
            if (!name || value <= 0) {
                alert('لطفاً اطلاعات ضروری را وارد کنید');
                return;
            }
            
            const asset = {
                id: Date.now(),
                name,
                value,
                quantity,
                description,
                date: new Date().toLocaleDateString('fa-IR')
            };
            
            assetsData.push(asset);
            updateAssetsDisplay();
            
            // پاک کردن فرم
            document.getElementById('asset-name').value = '';
            document.getElementById('asset-value').value = '';
            document.getElementById('asset-quantity').value = '1';
            document.getElementById('asset-description').value = '';
            
            showSuccessMessage('دارایی با موفقیت اضافه شد');
        }

        // به‌روزرسانی نمایش دارایی‌ها
        function updateAssetsDisplay() {
            const assetsContainer = document.getElementById('assets-list');
            assetsContainer.innerHTML = '';
            
            if (assetsData.length === 0) {
                assetsContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #7f8c8d;">هیچ دارایی ثبت نشده است</div>';
                return;
            }
            
            let totalValue = 0;
            
            assetsData.forEach(asset => {
                const assetValue = asset.value * asset.quantity;
                totalValue += assetValue;
                
                const assetElement = document.createElement('div');
                assetElement.className = 'asset-item';
                assetElement.innerHTML = `
                    <div class="transaction-details">
                        <div class="transaction-title">${asset.name}</div>
                        <div class="transaction-meta">${asset.description} - ${asset.date}</div>
                    </div>
                    <div class="transaction-amount income">
                        ${assetValue.toLocaleString()} تومان
                    </div>
                    <div class="asset-controls">
                        <button class="asset-control-btn" onclick="editAsset(${asset.id})">✏️</button>
                        <button class="asset-control-btn danger" onclick="removeAsset(${asset.id})">🗑️</button>
                    </div>
                `;
                assetsContainer.appendChild(assetElement);
            });
            
            // به‌روزرسانی کل دارایی‌ها
            document.getElementById('total-assets').innerHTML = `
                <div class="profit-title">💰 کل دارایی‌های شما</div>
                <div class="profit-amount">${totalValue.toLocaleString()} تومان</div>
            `;
        }

        // حذف دارایی
        function removeAsset(id) {
            if (confirm('آیا از حذف این دارایی اطمینان دارید؟')) {
                assetsData = assetsData.filter(asset => asset.id !== id);
                updateAssetsDisplay();
                showSuccessMessage('دارایی با موفقیت حذف شد');
            }
        }

        // ویرایش دارایی
        function editAsset(id) {
            const asset = assetsData.find(a => a.id === id);
            if (asset) {
                document.getElementById('asset-name').value = asset.name;
                document.getElementById('asset-value').value = asset.value;
                document.getElementById('asset-quantity').value = asset.quantity;
                document.getElementById('asset-description').value = asset.description;
                
                // حذف دارایی قدیمی
                assetsData = assetsData.filter(a => a.id !== id);
                updateAssetsDisplay();
                
                showSuccessMessage('اطلاعات دارایی برای ویرایش بارگذاری شد');
            }
        }

        // افزودن کالا به فاکتور
        function addInvoiceItem() {
            const itemsContainer = document.getElementById('invoice-items');
            const itemRow = document.createElement('div');
            itemRow.className = 'invoice-item-row';
            itemRow.innerHTML = `
                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                    <input type="text" placeholder="نام کالا" class="item-name">
                    <input type="number" placeholder="تعداد" class="item-quantity" style="width: 80px;">
                    <input type="number" placeholder="قیمت واحد" class="item-price" style="width: 120px;">
                    <button type="button" class="add-cost-btn danger" onclick="removeInvoiceItem(this)">✕</button>
                </div>
            `;
            itemsContainer.appendChild(itemRow);
        }

        // حذف کالا از فاکتور
        function removeInvoiceItem(button) {
            button.closest('.invoice-item-row').remove();
        }

        // پاک کردن امضا
        function clearSignature() {
            if (signaturePad) {
                signaturePad.clear();
            }
        }

        // ایجاد فاکتور
        function generateInvoice() {
            const type = document.getElementById('invoice-type').value;
            const seller = document.getElementById('invoice-seller').value;
            const buyer = document.getElementById('invoice-buyer').value;
            const date = document.getElementById('invoice-date').value || new Date().toISOString().split('T')[0];
            const notes = document.getElementById('invoice-notes').value;
            
            if (!seller || !buyer) {
                alert('لطفاً اطلاعات فروشنده و خریدار را وارد کنید');
                return;
            }
            
            // جمع‌آوری اقلام فاکتور
            const items = [];
            let total = 0;
            
            document.querySelectorAll('.invoice-item-row').forEach(row => {
                const name = row.querySelector('.item-name').value;
                const quantity = parseInt(row.querySelector('.item-quantity').value) || 0;
                const price = parseInt(row.querySelector('.item-price').value) || 0;
                
                if (name && quantity > 0 && price > 0) {
                    const itemTotal = quantity * price;
                    total += itemTotal;
                    
                    items.push({
                        name,
                        quantity,
                        price,
                        total: itemTotal
                    });
                }
            });
            
            if (items.length === 0) {
                alert('لطفاً حداقل یک کالا به فاکتور اضافه کنید');
                return;
            }
            
            // ایجاد پیش‌نمایش فاکتور
            const previewContainer = document.getElementById('invoice-preview');
            previewContainer.style.display = 'block';
            
            previewContainer.innerHTML = `
                <div class="invoice-header">
                    <h2>فاکتور ${type === 'sale' ? 'فروش' : 'خرید'}</h2>
                    <p>شماره: ${Date.now()}</p>
                    <p>تاریخ: ${date}</p>
                </div>
                
                <div class="invoice-details">
                    <div>
                        <strong>فروشنده:</strong> ${seller}
                    </div>
                    <div>
                        <strong>خریدار:</strong> ${buyer}
                    </div>
                </div>
                
                <table class="invoice-items">
                    <thead>
                        <tr>
                            <th>ردیف</th>
                            <th>نام کالا</th>
                            <th>تعداد</th>
                            <th>قیمت واحد (تومان)</th>
                            <th>جمع (تومان)</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${items.map((item, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${item.name}</td>
                                <td>${item.quantity}</td>
                                <td>${item.price.toLocaleString()}</td>
                                <td>${item.total.toLocaleString()}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
                
                <div class="invoice-total">
                    <strong>مبلغ کل فاکتور: ${total.toLocaleString()} تومان</strong>
                </div>
                
                ${notes ? `<div style="margin-top: 15px;"><strong>توضیحات:</strong> ${notes}</div>` : ''}
                
                <div class="invoice-signatures">
                    <div class="signature-box">
                        <div>امضا فروشنده</div>
                        <div class="signature-line"></div>
                    </div>
                    <div class="signature-box">
                        <div>امضا خریدار</div>
                        <div class="signature-line"></div>
                    </div>
                </div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn" onclick="downloadInvoice()">
                        <span>📥</span> دانلود فاکتور
                    </button>
                </div>
            `;
            
            // ذخیره فاکتور
            const invoice = {
                id: Date.now(),
                type,
                seller,
                buyer,
                date,
                items,
                total,
                notes,
                signature: signaturePad ? signaturePad.toDataURL() : null
            };
            
            invoicesData.push(invoice);
            
            showSuccessMessage('فاکتور با موفقیت ایجاد شد');
        }

        // دانلود فاکتور
        function downloadInvoice() {
            alert('عملکرد دانلود فاکتور در این نسخه دمو فعال است. در نسخه کامل، فاکتور به صورت PDF دانلود خواهد شد.');
            showSuccessMessage('فاکتور آماده دانلود است');
        }

        // کپی شماره کارت
        function copyCardNumber() {
            const cardNumber = '5892101187322777';
            navigator.clipboard.writeText(cardNumber)
                .then(() => {
                    showSuccessMessage('شماره کارت کپی شد');
                })
                .catch(err => {
                    alert('خطا در کپی کردن شماره کارت');
                });
        }

        // ثبت حمایت مالی
        function submitDonation() {
            const amount = parseInt(document.getElementById('donation-amount').value) || 0;
            const message = document.getElementById('donation-message').value;
            
            if (amount <= 0) {
                alert('لطفاً مبلغ معتبر وارد کنید');
                return;
            }
            
            // در اینجا معمولاً اطلاعات به سرور ارسال می‌شود
            // در این نسخه دمو فقط پیام نمایش داده می‌شود
            
            const thankYouMessage = `
                🙏 با تشکر از حمایت شما!
                
                مبلغ حمایت: ${amount.toLocaleString()} تومان
                ${message ? `پیام شما: ${message}` : ''}
                
                شماره کارت برای واریز:
                5892101187322777
                
                پس از واریز، رسید را برای ما ارسال کنید.
            `;
            
            alert(thankYouMessage);
            
            // پاک کردن فرم
            document.getElementById('donation-amount').value = '';
            document.getElementById('donation-message').value = '';
            
            showSuccessMessage('اطلاعات حمایت مالی ثبت شد');
        }

        // مقداردهی اولیه هنگام بارگذاری صفحه
        document.addEventListener('DOMContentLoaded', function() {
            // تنظیم تاریخ امروز به صورت پیش‌فرض
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('invoice-date').value = today;
            document.getElementById('employee-start-date').value = today;
            document.getElementById('check-due-date').value = today;
            
            // به‌روزرسانی نمایش‌ها
            updateFinanceDisplay();
            updateChecksDisplay();
            updateEmployeesDisplay();
            updateAssetsDisplay();
            updateAccountingDisplay();
        });
    </script>
</body>
</html>
