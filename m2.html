<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ­ Ø³ÛŒØ³ØªÙ… Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ ØªÙˆÙ„ÛŒØ¯ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ - Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <style>
        :root {
            --primary: #00b894;
            --primary-dark: #00a085;
            --secondary: #2d3436;
            --accent: #0984e3;
            --danger: #e74c3c;
            --warning: #f39c12;
            --success: #27ae60;
            --purple: #9b59b6;
            --teal: #00cec9;
            --pink: #fd79a8;
            --orange: #e17055;
            --blue: #74b9ff;
            --dark: #2d3436;
            --light: #dfe6e9;
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --rainbow: linear-gradient(90deg, #ff7675, #fd79a8, #74b9ff, #55efc4, #ffeaa7, #ff7675);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazir', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: calc(100vh - 40px);
            border-radius: 25px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.35);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--teal), var(--blue));
            color: white;
            padding: 25px;
            text-align: center;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 10px;
            font-weight: 900;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            opacity: 0.95;
            font-size: 1em;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .back-btn {
            position: absolute;
            top: 25px;
            right: 25px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 800;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
        }

        .content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 25px;
        }

        /* Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø§Ù„Ú¯ÙˆÙ‡Ø§ */
        .patterns-sidebar {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 25px;
            border: 2px solid var(--primary);
        }

        .patterns-title {
            font-size: 1.3em;
            font-weight: 900;
            margin-bottom: 20px;
            color: var(--dark);
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .patterns-list {
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 5px;
        }

        .pattern-item {
            background: white;
            padding: 18px;
            margin-bottom: 12px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-right: 4px solid var(--teal);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .pattern-item:hover {
            transform: translateX(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            border-right-color: var(--primary);
        }

        .pattern-item.active {
            border-right-color: var(--primary);
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.1), rgba(116, 185, 255, 0.1));
            box-shadow: 0 8px 20px rgba(0, 184, 148, 0.2);
        }

        .pattern-name {
            font-weight: 800;
            font-size: 1em;
            color: var(--dark);
            margin-bottom: 8px;
        }

        .pattern-desc {
            font-size: 0.85em;
            color: #636e72;
            line-height: 1.4;
        }

        .pattern-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.8em;
            color: var(--accent);
        }

        .pattern-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .pattern-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            font-size: 0.8em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pattern-btn.load {
            background: var(--primary);
            color: white;
        }

        .pattern-btn.delete {
            background: var(--danger);
            color: white;
        }

        .pattern-btn:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }

        .pattern-form {
            margin-top: 25px;
        }

        .form-container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            margin-bottom: 25px;
            border: 2px solid var(--teal);
            position: relative;
            overflow: hidden;
        }

        .form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--primary), var(--teal), var(--blue));
        }

        .form-title {
            font-size: 1.4em;
            font-weight: 900;
            margin-bottom: 25px;
            color: var(--dark);
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .form-group {
            margin-bottom: 22px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 800;
            color: var(--dark);
            font-size: 0.95em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        input, select, textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: #f8f9fa;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 4px rgba(0, 184, 148, 0.15);
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), var(--teal));
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 900;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 8px 20px rgba(0, 184, 148, 0.35);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.25), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 25px rgba(0, 184, 148, 0.45);
        }

        .btn:active {
            transform: translateY(2px);
        }

        .btn.loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--rainbow);
            background-size: 200% 100%;
            animation: rainbow-loading 1.5s linear infinite;
        }

        @keyframes rainbow-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .btn-purple {
            background: linear-gradient(135deg, var(--purple), #8e44ad);
            box-shadow: 0 8px 20px rgba(155, 89, 182, 0.35);
        }

        .btn-purple:hover {
            box-shadow: 0 12px 25px rgba(155, 89, 182, 0.45);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.35);
        }

        .btn-danger:hover {
            box-shadow: 0 12px 25px rgba(231, 76, 60, 0.45);
        }

        .btn-blue {
            background: linear-gradient(135deg, var(--blue), #0984e3);
            box-shadow: 0 8px 20px rgba(116, 185, 255, 0.35);
        }

        .btn-blue:hover {
            box-shadow: 0 12px 25px rgba(116, 185, 255, 0.45);
        }

        .success-message {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            margin: 18px 0;
            font-weight: 800;
            box-shadow: 0 8px 20px rgba(39, 174, 96, 0.4);
            animation: slideIn 0.5s ease-out;
            font-size: 0.95em;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ */
        .advanced-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .advanced-section {
            background: white;
            border-radius: 18px;
            padding: 22px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid var(--teal);
        }

        .section-title {
            font-size: 1.2em;
            font-weight: 900;
            margin-bottom: 18px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--primary);
        }

        .cost-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .cost-category {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 18px;
            border-radius: 12px;
            border: 2px solid var(--primary);
        }

        .category-title {
            font-weight: 800;
            margin-bottom: 12px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cost-inputs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }

        .cost-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .cost-input-group input {
            flex: 1;
        }

        .add-cost-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            font-weight: 800;
            margin-top: 10px;
        }

        .add-cost-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }

        .remove-cost-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 10px 14px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            min-width: 42px;
        }

        .remove-cost-btn:hover {
            background: #c0392b;
            transform: scale(1.08);
        }

        .production-result {
            background: linear-gradient(135deg, var(--accent), #0984e3);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 25px 0;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
            display: none;
            border: 3px solid white;
        }

        .production-title {
            font-size: 1.3em;
            font-weight: 900;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .cost-breakdown {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.4);
        }

        .cost-item:last-child {
            border-bottom: none;
        }

        .cost-label {
            font-weight: 800;
            font-size: 1em;
        }

        .cost-value {
            font-weight: 900;
            font-size: 1.1em;
        }

        .final-price-section {
            text-align: center;
            margin: 30px 0;
            padding: 25px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            border: 3px solid white;
        }

        .price-label {
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: 800;
        }

        .price-amount {
            font-size: 2.2em;
            font-weight: 900;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.4);
        }

        .profit-display {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
            box-shadow: 0 10px 25px rgba(253, 203, 110, 0.5);
            border: 2px solid white;
        }

        .profit-title {
            font-size: 1.1em;
            font-weight: 900;
            margin-bottom: 15px;
        }

        .profit-amount {
            font-size: 2em;
            font-weight: 900;
        }

        .advice-section {
            background: rgba(255, 255, 255, 0.95);
            border: 3px solid var(--primary);
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            color: var(--dark);
        }

        .advice-title {
            color: var(--dark);
            font-weight: 900;
            margin-bottom: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .advice-content {
            color: #2c3e50;
            line-height: 1.7;
            font-size: 0.95em;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            margin: 25px 0;
            height: 350px;
            border: 2px solid var(--teal);
        }

        .history-list {
            margin-top: 25px;
        }

        .history-item {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 15px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
            border-right: 5px solid var(--purple);
            transition: all 0.3s;
        }

        .history-item:hover {
            transform: translateX(-8px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .history-product {
            font-weight: 900;
            font-size: 1.05em;
            color: var(--dark);
        }

        .history-date {
            font-size: 0.85em;
            color: #7f8c8d;
            font-weight: 700;
        }

        .history-details {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            font-size: 0.9em;
        }

        .history-detail {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
        }

        .empty-state {
            text-align: center;
            padding: 50px 25px;
            color: #7f8c8d;
        }

        .empty-state .icon {
            font-size: 3.5em;
            margin-bottom: 20px;
            opacity: 0.6;
        }

        .empty-state p {
            font-size: 1.1em;
        }

        /* Ø³ÛŒØ³ØªÙ… Ø§Ù„Ú¯ÙˆÙ‡Ø§ */
        .pattern-management {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .pattern-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            border: 2px solid var(--primary);
            transition: all 0.3s;
        }

        .pattern-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .pattern-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .pattern-card-title {
            font-weight: 900;
            font-size: 1.2em;
            color: var(--dark);
        }

        .pattern-card-desc {
            font-size: 0.9em;
            color: #636e72;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .pattern-card-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        .pattern-stat {
            background: white;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--teal);
        }

        .stat-value {
            font-weight: 900;
            font-size: 1.1em;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.8em;
            color: #636e72;
            margin-top: 5px;
        }

        /* ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
            text-align: center;
            transition: transform 0.3s;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--teal), var(--blue));
        }

        .feature-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            font-size: 3em;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--primary), var(--teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .feature-title {
            font-weight: 900;
            margin-bottom: 10px;
            color: var(--dark);
            font-size: 1em;
        }

        .feature-desc {
            font-size: 0.85em;
            color: #7f8c8d;
            line-height: 1.5;
        }

        /* ØªÚ¯â€ŒÙ‡Ø§ÛŒ ÙˆØ¶Ø¹ÛŒØª */
        .status-tag {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 800;
            margin: 5px;
        }

        .status-high {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
        }

        .status-medium {
            background: linear-gradient(135deg, var(--warning), #f39c12);
            color: white;
        }

        .status-low {
            background: linear-gradient(135deg, var(--danger), #c0392b);
            color: white;
        }

        /* Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
            }
            
            .patterns-sidebar {
                position: static;
                margin-bottom: 25px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                min-height: calc(100vh - 20px);
                border-radius: 20px;
            }
            
            .content {
                padding: 15px;
            }
            
            .form-container {
                padding: 20px;
            }
            
            .advanced-sections {
                grid-template-columns: 1fr;
            }
            
            .history-details {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .feature-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.4em;
            }
            
            .back-btn {
                top: 15px;
                right: 15px;
                padding: 10px 15px;
                font-size: 0.9em;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .history-details {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 300px;
                padding: 15px;
            }
            
            .production-result {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="index.html" class="back-btn">
                <span>â†</span> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
            </a>
            <h1>ğŸ­ Ø³ÛŒØ³ØªÙ… Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ ØªÙˆÙ„ÛŒØ¯ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h1>
            <p>Ø³ÛŒØ³ØªÙ… Ø¬Ø§Ù…Ø¹ Ù…Ø¯ÛŒØ±ÛŒØª ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ ÛµÛ° Ø§Ù„Ú¯ÙˆÛŒ Ø·Ø±Ø§Ø­ÛŒØŒ Û³Û° ÙˆÛŒÚ˜Ú¯ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ùˆ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù‚ÛŒÙ…Øª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡</p>
        </div>

        <div class="content">
            <!-- Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø§Ù„Ú¯ÙˆÙ‡Ø§ -->
            <div class="patterns-sidebar">
                <h2 class="patterns-title">
                    <span>ğŸ“</span> Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ÛŒ
                </h2>
                
                <div class="patterns-list" id="patterns-list">
                    <!-- Ø§Ù„Ú¯ÙˆÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </div>
                
                <div class="pattern-form">
                    <h3 style="margin-bottom: 15px; color: var(--dark); font-weight: 800;">
                        <span>âœ¨</span> Ø§ÛŒØ¬Ø§Ø¯ Ø§Ù„Ú¯ÙˆÛŒ Ø¬Ø¯ÛŒØ¯
                    </h3>
                    <input type="text" id="new-pattern-name" placeholder="Ù†Ø§Ù… Ø§Ù„Ú¯Ùˆ (Ù…Ø«Ù„Ø§Ù‹: ØªÙˆÙ„ÛŒØ¯ Ù¾ÙˆØ´Ø§Ú©)" style="margin-bottom: 12px;">
                    <textarea id="new-pattern-desc" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ø§Ù„Ú¯Ùˆ" rows="3" style="margin-bottom: 12px;"></textarea>
                    <button class="btn btn-blue" onclick="createNewPattern()">
                        <span>â•</span> Ø§ÛŒØ¬Ø§Ø¯ Ø§Ù„Ú¯ÙˆÛŒ Ø¬Ø¯ÛŒØ¯
                    </button>
                </div>
            </div>

            <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
            <div class="main-content">
                <!-- ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">ğŸ¤–</div>
                        <div class="feature-title">Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÚ¯Ø±</div>
                        <div class="feature-desc">ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ†</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">ğŸ“ˆ</div>
                        <div class="feature-title">Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø¨Ø§Ø²Ø§Ø±</div>
                        <div class="feature-desc">Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ Ù†ÙˆØ³Ø§Ù†Ø§Øª Ø¨Ø§Ø²Ø§Ø±</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">ğŸ”„</div>
                        <div class="feature-title">Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡ ØªØ£Ù…ÛŒÙ†</div>
                        <div class="feature-desc">Ú©Ø§Ù‡Ø´ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù„Ø¬Ø³ØªÛŒÚ© Ùˆ ØªØ£Ù…ÛŒÙ† Ù…ÙˆØ§Ø¯</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">âš¡</div>
                        <div class="feature-title">Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¨Ù„Ø§Ø¯Ø±Ù†Ú¯</div>
                        <div class="feature-desc">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‚ÛŒÙ…Øª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡ Ø¯Ø± Ù„Ø­Ø¸Ù‡ Ø¨Ø§ Ù‡Ø± ØªØºÛŒÛŒØ±</div>
                    </div>
                </div>

                <!-- ÙØ±Ù… Ø§ØµÙ„ÛŒ Ù…Ø­Ø§Ø³Ø¨Ø§Øª -->
                <div class="form-container">
                    <h2 class="form-title" id="current-pattern-title">
                        <span>ğŸ§®</span> Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‚ÛŒÙ…Øª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡
                    </h2>
                    
                    <div class="form-group">
                        <label for="product-name">
                            <span>ğŸ·ï¸</span> Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„:
                        </label>
                        <input type="text" id="product-name" placeholder="Ù†Ø§Ù… Ú©Ø§Ù…Ù„ Ù…Ø­ØµÙˆÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                    </div>
                    
                    <div class="form-group">
                        <label for="material-cost">
                            <span>ğŸ’°</span> Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„ Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡ (ØªÙˆÙ…Ø§Ù†):
                        </label>
                        <input type="number" id="material-cost" placeholder="Ù…Ø«Ù„Ø§Ù‹ 50000000 Ø¨Ø±Ø§ÛŒ 50 Ù…ÛŒÙ„ÛŒÙˆÙ†">
                    </div>
                    
                    <div class="form-group">
                        <label for="production-quantity">
                            <span>ğŸ“¦</span> ØªØ¹Ø¯Ø§Ø¯ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡:
                        </label>
                        <input type="number" id="production-quantity" placeholder="ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ ØªÙˆÙ„ÛŒØ¯">
                    </div>

                    <!-- Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ -->
                    <div class="advanced-sections">
                        <!-- Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø± -->
                        <div class="advanced-section">
                            <h3 class="section-title">
                                <span>ğŸ‘¥</span> Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±
                            </h3>
                            <div id="labor-costs">
                                <div class="cost-input-group">
                                    <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø´ØºÙ„" id="labor-title-1">
                                    <input type="number" placeholder="ØªØ¹Ø¯Ø§Ø¯ Ù†ÙØ±" id="labor-count-1">
                                    <input type="number" placeholder="Ø­Ù‚ÙˆÙ‚ Ù…Ø§Ù‡Ø§Ù†Ù‡" id="labor-salary-1">
                                    <button class="remove-cost-btn" onclick="removeLaborField(1)">âœ•</button>
                                </div>
                            </div>
                            <button type="button" class="add-cost-btn" onclick="addLaborField()">
                                <span>â•</span> Ø§ÙØ²ÙˆØ¯Ù† Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±
                            </button>
                        </div>

                        <!-- Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø±Ø¨Ø§Ø± -->
                        <div class="advanced-section">
                            <h3 class="section-title">
                                <span>ğŸ¢</span> Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø±Ø¨Ø§Ø±
                            </h3>
                            <div id="overhead-costs">
                                <div class="cost-input-group">
                                    <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ù‡Ø²ÛŒÙ†Ù‡" id="overhead-title-1">
                                    <input type="number" placeholder="Ù…Ø¨Ù„Øº Ù…Ø§Ù‡Ø§Ù†Ù‡" id="overhead-amount-1">
                                    <button class="remove-cost-btn" onclick="removeOverheadField(1)">âœ•</button>
                                </div>
                            </div>
                            <button type="button" class="add-cost-btn" onclick="addOverheadField()">
                                <span>â•</span> Ø§ÙØ²ÙˆØ¯Ù† Ù‡Ø²ÛŒÙ†Ù‡ Ø³Ø±Ø¨Ø§Ø±
                            </button>
                        </div>
                    </div>

                    <!-- Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ± -->
                    <div class="form-group">
                        <h3 style="margin-bottom: 15px; color: var(--dark); font-weight: 800; display: flex; align-items: center; gap: 10px;">
                            <span>ğŸ“Š</span> Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ± ØªÙˆÙ„ÛŒØ¯:
                        </h3>
                        <div id="variable-costs">
                            <div class="cost-input-group">
                                <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ù‡Ø²ÛŒÙ†Ù‡ Ù…ØªØºÛŒØ±" id="variable-title-1" style="flex: 2;">
                                <input type="number" placeholder="Ù…Ø¨Ù„Øº (ØªÙˆÙ…Ø§Ù†)" id="variable-amount-1" style="flex: 1;">
                                <button class="remove-cost-btn" onclick="removeVariableField(1)">âœ•</button>
                            </div>
                        </div>
                        <button type="button" class="add-cost-btn" onclick="addVariableField()">
                            <span>â•</span> Ø§ÙØ²ÙˆØ¯Ù† Ù‡Ø²ÛŒÙ†Ù‡ Ù…ØªØºÛŒØ±
                        </button>
                    </div>

                    <!-- Ø³ÙˆØ¯ Ùˆ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ -->
                    <div class="advanced-sections">
                        <div class="advanced-section">
                            <h3 class="section-title">
                                <span>ğŸ¯</span> Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ
                            </h3>
                            <div class="form-group">
                                <label for="pricing-strategy">Ù†ÙˆØ¹ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ:</label>
                                <select id="pricing-strategy">
                                    <option value="cost-plus">Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø±Ø§Ø³Ø§Ø³ Ù‡Ø²ÛŒÙ†Ù‡</option>
                                    <option value="market-based">Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø±Ø§Ø³Ø§Ø³ Ø¨Ø§Ø²Ø§Ø±</option>
                                    <option value="value-based">Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø±Ø§Ø³Ø§Ø³ Ø§Ø±Ø²Ø´</option>
                                    <option value="competitive">Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="desired-profit">Ø³ÙˆØ¯ Ù‡Ø¯Ù Ø´Ù…Ø§ (Ø¯Ø±ØµØ¯):</label>
                                <input type="number" id="desired-profit" placeholder="Ù…Ø«Ù„Ø§Ù‹ 30 Ø¨Ø±Ø§ÛŒ 30% Ø³ÙˆØ¯" min="0" max="1000" value="30">
                            </div>
                            <div class="form-group">
                                <label for="tax-rate">Ù†Ø±Ø® Ù…Ø§Ù„ÛŒØ§Øª (Ø¯Ø±ØµØ¯):</label>
                                <input type="number" id="tax-rate" placeholder="Ù†Ø±Ø® Ù…Ø§Ù„ÛŒØ§Øª Ø¨Ø± Ø§Ø±Ø²Ø´ Ø§ÙØ²ÙˆØ¯Ù‡" min="0" max="100" value="9">
                            </div>
                        </div>

                        <div class="advanced-section">
                            <h3 class="section-title">
                                <span>ğŸ“ˆ</span> ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ
                            </h3>
                            <div class="form-group">
                                <label for="market-price">Ù‚ÛŒÙ…Øª Ù…ØªÙˆØ³Ø· Ø¨Ø§Ø²Ø§Ø± (ØªÙˆÙ…Ø§Ù†):</label>
                                <input type="number" id="market-price" placeholder="Ù‚ÛŒÙ…Øª Ø±Ù‚Ø¨Ø§ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø±">
                            </div>
                            <div class="form-group">
                                <label for="competition-level">Ø³Ø·Ø­ Ø±Ù‚Ø§Ø¨Øª:</label>
                                <select id="competition-level">
                                    <option value="high">Ø±Ù‚Ø§Ø¨Øª Ø´Ø¯ÛŒØ¯</option>
                                    <option value="medium">Ø±Ù‚Ø§Ø¨Øª Ù…ØªÙˆØ³Ø·</option>
                                    <option value="low">Ø±Ù‚Ø§Ø¨Øª Ú©Ù…</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="target-margin">Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯ Ù‡Ø¯Ù:</label>
                                <select id="target-margin">
                                    <option value="aggressive">Ø­Ø§Ø´ÛŒÙ‡ ØªÙ‡Ø§Ø¬Ù…ÛŒ (Ú©Ù…)</option>
                                    <option value="standard">Ø­Ø§Ø´ÛŒÙ‡ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯</option>
                                    <option value="premium">Ø­Ø§Ø´ÛŒÙ‡ Ù¾Ø±ÛŒÙ…ÛŒÙˆÙ… (Ø¨Ø§Ù„Ø§)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 25px;">
                        <button class="btn btn-purple" onclick="calculateAdvancedProduction()">
                            <span>ğŸš€</span> Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡
                        </button>
                        <button class="btn btn-blue" onclick="saveCurrentPattern()">
                            <span>ğŸ’¾</span> Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø§Ù„Ú¯Ùˆ
                        </button>
                    </div>
                    
                    <button class="btn btn-danger" onclick="clearAllData()" style="margin-top: 15px;">
                        <span>ğŸ—‘ï¸</span> Ø­Ø°Ù ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    </button>
                    
                    <button class="btn" onclick="exportToExcel()" style="margin-top: 15px; background: linear-gradient(135deg, #00cec9, #00b894);">
                        <span>ğŸ“¤</span> Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„
                    </button>
                </div>

                <!-- Ù†ØªØ§ÛŒØ¬ Ù…Ø­Ø§Ø³Ø¨Ø§Øª -->
                <div id="production-result" class="production-result">
                    <h2 class="production-title">ğŸ“Š Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ ØªÙˆÙ„ÛŒØ¯</h2>
                    
                    <div class="cost-breakdown">
                        <div class="cost-item">
                            <span class="cost-label">Ù‡Ø²ÛŒÙ†Ù‡ Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡:</span>
                            <span class="cost-value" id="result-material-cost">0 ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">Ù‡Ø²ÛŒÙ†Ù‡ Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±:</span>
                            <span class="cost-value" id="result-labor-cost">0 ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø±Ø¨Ø§Ø±:</span>
                            <span class="cost-value" id="result-overhead-cost">0 ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ±:</span>
                            <span class="cost-value" id="result-variable-cost">0 ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">Ù…Ø§Ù„ÛŒØ§Øª Ùˆ Ø¹ÙˆØ§Ø±Ø¶:</span>
                            <span class="cost-value" id="result-tax-cost">0 ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="cost-item" style="border-top: 2px solid white; padding-top: 18px;">
                            <span class="cost-label">Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„ ØªÙˆÙ„ÛŒØ¯:</span>
                            <span class="cost-value" style="font-size: 1.2em;">0 ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="cost-item">
                            <span class="cost-label">Ù‡Ø²ÛŒÙ†Ù‡ Ù‡Ø± ÙˆØ§Ø­Ø¯:</span>
                            <span class="cost-value" id="result-unit-cost">0 ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                    </div>

                    <div class="final-price-section">
                        <div class="price-label">ğŸ’° Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ù‡Ø± ÙˆØ§Ø­Ø¯:</div>
                        <div class="price-amount" id="result-final-price">0 ØªÙˆÙ…Ø§Ù†</div>
                        <div style="margin-top: 15px; font-size: 0.9em; opacity: 0.9;">
                            <span id="price-comparison"></span>
                        </div>
                    </div>

                    <div class="profit-display">
                        <div class="profit-title">ğŸ’µ Ø³ÙˆØ¯ Ø®Ø§Ù„Øµ Ú©Ù„ Ù¾Ø±ÙˆÚ˜Ù‡:</div>
                        <div class="profit-amount" id="result-total-profit">0 ØªÙˆÙ…Ø§Ù†</div>
                        <div style="margin-top: 15px; font-size: 0.9em;">
                            Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯: <span id="result-profit-margin" style="font-weight: 800;">0%</span>
                        </div>
                    </div>

                    <!-- ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
                    <div class="advice-section">
                        <div class="advice-title">
                            <span>ğŸ¤–</span> ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ùˆ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØªÛŒ:
                        </div>
                        <div class="advice-content" id="production-advice">
                            Ù…Ù†ØªØ¸Ø± Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø´Ù…Ø§ Ù‡Ø³ØªÛŒÙ…...
                        </div>
                    </div>

                    <!-- Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
                    <div class="advanced-sections">
                        <div class="chart-container">
                            <canvas id="costDistributionChart"></canvas>
                        </div>
                        <div class="chart-container">
                            <canvas id="profitAnalysisChart"></canvas>
                        </div>
                    </div>

                    <!-- ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ -->
                    <div class="advice-section" style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white;">
                        <div class="advice-title">
                            <span>ğŸ†</span> ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ Ùˆ Ù…ÙˆÙ‚Ø¹ÛŒØªâ€ŒØ³Ù†Ø¬ÛŒ Ø¨Ø§Ø²Ø§Ø±:
                        </div>
                        <div class="advice-content" id="competitive-analysis">
                            ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ Ù¾Ø³ Ø§Ø² Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
                        </div>
                    </div>
                </div>

                <!-- ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ùˆ Ú¯Ø²Ø§Ø±Ø´Ø§Øª -->
                <div class="form-container">
                    <h2 class="form-title">ğŸ“‹ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ùˆ Ú¯Ø²Ø§Ø±Ø´Ø§Øª</h2>
                    <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                        <button class="btn btn-purple" onclick="generateFullReport()" style="flex: 1;">
                            <span>ğŸ“„</span> ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ù…Ù„
                        </button>
                        <button class="btn btn-blue" onclick="showComparativeAnalysis()" style="flex: 1;">
                            <span>ğŸ“Š</span> ØªØ­Ù„ÛŒÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ
                        </button>
                    </div>
                    <div class="history-list" id="production-history">
                        <!-- ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù„Ú¯ÙˆÙ‡Ø§ - ÛµÛ° Ø§Ù„Ú¯ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯
        // ============================================
        
        let patterns = JSON.parse(localStorage.getItem('productionPatterns')) || [];
        let currentPattern = null;
        let productionData = JSON.parse(localStorage.getItem('advancedProductionData')) || [];
        let laborCosts = [];
        let overheadCosts = [];
        let variableCosts = [];
        let costDistributionChart = null;
        let profitAnalysisChart = null;

        // Ù†Ù…ÙˆÙ†Ù‡ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        const defaultPatterns = [
            {
                id: 1,
                name: "ØªÙˆÙ„ÛŒØ¯ Ù¾ÙˆØ´Ø§Ú©",
                description: "Ø§Ù„Ú¯ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØµÙ†Ø¹Øª Ù¾ÙˆØ´Ø§Ú© Ùˆ Ù…Ø¯",
                category: "Ù¾ÙˆØ´Ø§Ú©",
                materialCost: 50000000,
                laborCost: 20000000,
                overheadCost: 10000000,
                variableCost: 5000000,
                profitMargin: 35,
                productionTime: 30,
                complexity: "Ù…ØªÙˆØ³Ø·"
            },
            {
                id: 2,
                name: "ØªÙˆÙ„ÛŒØ¯ Ù…ÙˆØ§Ø¯ ØºØ°Ø§ÛŒÛŒ",
                description: "Ø§Ù„Ú¯ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØµÙ†Ø§ÛŒØ¹ ØºØ°Ø§ÛŒÛŒ",
                category: "ØºØ°Ø§ÛŒÛŒ",
                materialCost: 30000000,
                laborCost: 15000000,
                overheadCost: 8000000,
                variableCost: 4000000,
                profitMargin: 25,
                productionTime: 15,
                complexity: "Ø¢Ø³Ø§Ù†"
            },
            {
                id: 3,
                name: "ØªÙˆÙ„ÛŒØ¯ Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©",
                description: "Ø§Ù„Ú¯ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØªØ¬Ù‡ÛŒØ²Ø§Øª Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©ÛŒ",
                category: "Ø§Ù„Ú©ØªØ±ÙˆÙ†ÛŒÚ©",
                materialCost: 100000000,
                laborCost: 30000000,
                overheadCost: 20000000,
                variableCost: 10000000,
                profitMargin: 40,
                productionTime: 45,
                complexity: "Ù¾ÛŒÚ†ÛŒØ¯Ù‡"
            },
            {
                id: 4,
                name: "ØªÙˆÙ„ÛŒØ¯ Ù…Ø¨Ù„Ù…Ø§Ù†",
                description: "Ø§Ù„Ú¯ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØµÙ†Ø¹Øª Ú†ÙˆØ¨ Ùˆ Ù…Ø¨Ù„Ù…Ø§Ù†",
                category: "Ù…Ø¨Ù„Ù…Ø§Ù†",
                materialCost: 40000000,
                laborCost: 25000000,
                overheadCost: 12000000,
                variableCost: 6000000,
                profitMargin: 45,
                productionTime: 35,
                complexity: "Ù…ØªÙˆØ³Ø·"
            },
            {
                id: 5,
                name: "ØªÙˆÙ„ÛŒØ¯ Ù…ÙˆØ§Ø¯ Ø´ÙˆÛŒÙ†Ø¯Ù‡",
                description: "Ø§Ù„Ú¯ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ§Ø¯ Ø´ÙˆÛŒÙ†Ø¯Ù‡ Ùˆ Ø¨Ù‡Ø¯Ø§Ø´ØªÛŒ",
                category: "Ø´ÛŒÙ…ÛŒØ§ÛŒÛŒ",
                materialCost: 20000000,
                laborCost: 10000000,
                overheadCost: 6000000,
                variableCost: 3000000,
                profitMargin: 30,
                productionTime: 20,
                complexity: "Ø¢Ø³Ø§Ù†"
            }
        ];

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        window.onload = function() {
            if (patterns.length === 0) {
                patterns = defaultPatterns;
                savePatterns();
            }
            
            renderPatternsList();
            renderProductionHistory();
            initializeCostFields();
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¢Ø®Ø±ÛŒÙ† Ø§Ù„Ú¯ÙˆÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡
            const lastPatternId = localStorage.getItem('lastPatternId');
            if (lastPatternId) {
                loadPattern(parseInt(lastPatternId));
            }
        };

        // ============================================
        // Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ù„Ú¯ÙˆÙ‡Ø§
        // ============================================

        function renderPatternsList() {
            const container = document.getElementById('patterns-list');
            container.innerHTML = '';
            
            patterns.forEach(pattern => {
                const patternEl = document.createElement('div');
                patternEl.className = `pattern-item ${currentPattern && currentPattern.id === pattern.id ? 'active' : ''}`;
                patternEl.innerHTML = `
                    <div class="pattern-name">${pattern.name}</div>
                    <div class="pattern-desc">${pattern.description}</div>
                    <div class="pattern-stats">
                        <span>Ø³ÙˆØ¯: ${pattern.profitMargin}%</span>
                        <span>${pattern.category}</span>
                    </div>
                    <div class="pattern-actions">
                        <button class="pattern-btn load" onclick="loadPattern(${pattern.id})">
                            Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
                        </button>
                        <button class="pattern-btn delete" onclick="deletePattern(${pattern.id})">
                            Ø­Ø°Ù
                        </button>
                    </div>
                `;
                container.appendChild(patternEl);
            });
        }

        function createNewPattern() {
            const name = document.getElementById('new-pattern-name').value;
            const desc = document.getElementById('new-pattern-desc').value;
            
            if (!name) {
                showErrorMessage('Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ø§Ù„Ú¯Ùˆ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            const newPattern = {
                id: Date.now(),
                name: name,
                description: desc || 'Ø¨Ø¯ÙˆÙ† ØªÙˆØ¶ÛŒØ­Ø§Øª',
                category: "Ø³ÙØ§Ø±Ø´ÛŒ",
                materialCost: 0,
                laborCost: 0,
                overheadCost: 0,
                variableCost: 0,
                profitMargin: 30,
                productionTime: 30,
                complexity: "Ù…ØªÙˆØ³Ø·",
                createdAt: new Date().toISOString()
            };
            
            patterns.push(newPattern);
            savePatterns();
            renderPatternsList();
            
            document.getElementById('new-pattern-name').value = '';
            document.getElementById('new-pattern-desc').value = '';
            
            showSuccessMessage(`Ø§Ù„Ú¯ÙˆÛŒ "${name}" Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯`);
        }

        function loadPattern(patternId) {
            const pattern = patterns.find(p => p.id === patternId);
            if (!pattern) return;
            
            currentPattern = pattern;
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù„Ú¯Ùˆ Ø¯Ø± ÙØ±Ù…
            document.getElementById('product-name').value = pattern.name;
            document.getElementById('material-cost').value = pattern.materialCost;
            document.getElementById('desired-profit').value = pattern.profitMargin;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¹Ù†ÙˆØ§Ù†
            document.getElementById('current-pattern-title').innerHTML = `
                <span>ğŸ§®</span> Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‚ÛŒÙ…Øª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡ - ${pattern.name}
            `;
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¢Ø®Ø±ÛŒÙ† Ø§Ù„Ú¯ÙˆÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡
            localStorage.setItem('lastPatternId', patternId);
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª
            renderPatternsList();
            
            showSuccessMessage(`Ø§Ù„Ú¯ÙˆÛŒ "${pattern.name}" Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯`);
        }

        function saveCurrentPattern() {
            if (!currentPattern) {
                showErrorMessage('Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ø§Ù„Ú¯Ùˆ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            // Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ¹Ù„ÛŒ Ø¯Ø± Ø§Ù„Ú¯Ùˆ
            currentPattern.materialCost = parseInt(document.getElementById('material-cost').value) || 0;
            currentPattern.profitMargin = parseInt(document.getElementById('desired-profit').value) || 30;
            
            savePatterns();
            showSuccessMessage(`Ø§Ù„Ú¯ÙˆÛŒ "${currentPattern.name}" Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯`);
        }

        function deletePattern(patternId) {
            if (!confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ø§Ù„Ú¯Ùˆ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) return;
            
            patterns = patterns.filter(p => p.id !== patternId);
            savePatterns();
            renderPatternsList();
            
            if (currentPattern && currentPattern.id === patternId) {
                currentPattern = null;
            }
            
            showSuccessMessage('Ø§Ù„Ú¯Ùˆ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯');
        }

        function savePatterns() {
            try {
                localStorage.setItem('productionPatterns', JSON.stringify(patterns));
            } catch(e) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø§Ù„Ú¯ÙˆÙ‡Ø§:', e);
            }
        }

        // ============================================
        // Ù…Ø¯ÛŒØ±ÛŒØª Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
        // ============================================

        function initializeCostFields() {
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            addLaborField();
            addOverheadField();
            addVariableField();
        }

        let laborCounter = 1;
        let overheadCounter = 1;
        let variableCounter = 1;

        function addLaborField() {
            laborCounter++;
            const container = document.getElementById('labor-costs');
            const field = document.createElement('div');
            field.className = 'cost-input-group';
            field.innerHTML = `
                <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø´ØºÙ„" id="labor-title-${laborCounter}">
                <input type="number" placeholder="ØªØ¹Ø¯Ø§Ø¯ Ù†ÙØ±" id="labor-count-${laborCounter}">
                <input type="number" placeholder="Ø­Ù‚ÙˆÙ‚ Ù…Ø§Ù‡Ø§Ù†Ù‡" id="labor-salary-${laborCounter}">
                <button class="remove-cost-btn" onclick="removeLaborField(${laborCounter})">âœ•</button>
            `;
            container.appendChild(field);
            laborCosts.push({ id: laborCounter, title: '', count: 0, salary: 0 });
        }

        function removeLaborField(id) {
            const field = document.querySelector(`#labor-title-${id}`)?.parentElement;
            if (field) {
                field.remove();
                laborCosts = laborCosts.filter(cost => cost.id !== id);
            }
        }

        function addOverheadField() {
            overheadCounter++;
            const container = document.getElementById('overhead-costs');
            const field = document.createElement('div');
            field.className = 'cost-input-group';
            field.innerHTML = `
                <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ù‡Ø²ÛŒÙ†Ù‡" id="overhead-title-${overheadCounter}">
                <input type="number" placeholder="Ù…Ø¨Ù„Øº Ù…Ø§Ù‡Ø§Ù†Ù‡" id="overhead-amount-${overheadCounter}">
                <button class="remove-cost-btn" onclick="removeOverheadField(${overheadCounter})">âœ•</button>
            `;
            container.appendChild(field);
            overheadCosts.push({ id: overheadCounter, title: '', amount: 0 });
        }

        function removeOverheadField(id) {
            const field = document.querySelector(`#overhead-title-${id}`)?.parentElement;
            if (field) {
                field.remove();
                overheadCosts = overheadCosts.filter(cost => cost.id !== id);
            }
        }

        function addVariableField() {
            variableCounter++;
            const container = document.getElementById('variable-costs');
            const field = document.createElement('div');
            field.className = 'cost-input-group';
            field.innerHTML = `
                <input type="text" placeholder="Ø¹Ù†ÙˆØ§Ù† Ù‡Ø²ÛŒÙ†Ù‡ Ù…ØªØºÛŒØ±" id="variable-title-${variableCounter}" style="flex: 2;">
                <input type="number" placeholder="Ù…Ø¨Ù„Øº (ØªÙˆÙ…Ø§Ù†)" id="variable-amount-${variableCounter}" style="flex: 1;">
                <button class="remove-cost-btn" onclick="removeVariableField(${variableCounter})">âœ•</button>
            `;
            container.appendChild(field);
            variableCosts.push({ id: variableCounter, title: '', amount: 0 });
        }

        function removeVariableField(id) {
            const field = document.querySelector(`#variable-title-${id}`)?.parentElement;
            if (field) {
                field.remove();
                variableCosts = variableCosts.filter(cost => cost.id !== id);
            }
        }

        // ============================================
        // Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡
        // ============================================

        function calculateAdvancedProduction() {
            const button = event.target;
            addLoading(button);
            
            setTimeout(() => {
                // Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
                const productName = document.getElementById('product-name').value;
                const materialCost = parseInt(document.getElementById('material-cost').value) || 0;
                const quantity = parseInt(document.getElementById('production-quantity').value) || 0;
                const desiredProfit = parseInt(document.getElementById('desired-profit').value) || 30;
                const taxRate = parseInt(document.getElementById('tax-rate').value) || 9;
                const marketPrice = parseInt(document.getElementById('market-price').value) || 0;
                const pricingStrategy = document.getElementById('pricing-strategy').value;
                const competitionLevel = document.getElementById('competition-level').value;
                const targetMargin = document.getElementById('target-margin').value;
                
                // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
                if (!productName || !materialCost || !quantity) {
                    showErrorMessage('Ù„Ø·ÙØ§Ù‹ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯');
                    return;
                }
                
                if (quantity <= 0) {
                    showErrorMessage('ØªØ¹Ø¯Ø§Ø¯ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ø¨Ø²Ø±Ú¯ØªØ± Ø§Ø² ØµÙØ± Ø¨Ø§Ø´Ø¯');
                    return;
                }
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‡Ø²ÛŒÙ†Ù‡ Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±
                let totalLaborCost = 0;
                const laborDetails = [];
                for (let i = 1; i <= laborCounter; i++) {
                    const title = document.getElementById(`labor-title-${i}`)?.value;
                    const count = parseInt(document.getElementById(`labor-count-${i}`)?.value) || 0;
                    const salary = parseInt(document.getElementById(`labor-salary-${i}`)?.value) || 0;
                    
                    if (title && count > 0 && salary > 0) {
                        const laborCost = count * salary;
                        totalLaborCost += laborCost;
                        laborDetails.push({ title, count, salary, total: laborCost });
                    }
                }
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø±Ø¨Ø§Ø±
                let totalOverheadCost = 0;
                const overheadDetails = [];
                for (let i = 1; i <= overheadCounter; i++) {
                    const title = document.getElementById(`overhead-title-${i}`)?.value;
                    const amount = parseInt(document.getElementById(`overhead-amount-${i}`)?.value) || 0;
                    
                    if (title && amount > 0) {
                        totalOverheadCost += amount;
                        overheadDetails.push({ title, amount });
                    }
                }
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ±
                let totalVariableCost = 0;
                const variableDetails = [];
                for (let i = 1; i <= variableCounter; i++) {
                    const title = document.getElementById(`variable-title-${i}`)?.value;
                    const amount = parseInt(document.getElementById(`variable-amount-${i}`)?.value) || 0;
                    
                    if (title && amount > 0) {
                        totalVariableCost += amount;
                        variableDetails.push({ title, amount });
                    }
                }
                
                // Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø§ØµÙ„ÛŒ
                const totalDirectCost = materialCost + totalLaborCost;
                const totalIndirectCost = totalOverheadCost + totalVariableCost;
                const totalCostBeforeTax = totalDirectCost + totalIndirectCost;
                const taxAmount = totalCostBeforeTax * (taxRate / 100);
                const totalCost = totalCostBeforeTax + taxAmount;
                
                const unitCost = totalCost / quantity;
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù‚ÛŒÙ…Øª Ø¨Ø±Ø§Ø³Ø§Ø³ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ
                let finalPrice = 0;
                let calculatedMargin = desiredProfit;
                
                switch(pricingStrategy) {
                    case 'market-based':
                        if (marketPrice > 0) {
                            finalPrice = marketPrice;
                            calculatedMargin = ((marketPrice - unitCost) / unitCost) * 100;
                        } else {
                            finalPrice = unitCost * (1 + desiredProfit / 100);
                        }
                        break;
                    case 'value-based':
                        // Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø±Ø§Ø³Ø§Ø³ Ø§Ø±Ø²Ø´ - Û²Û°Ùª Ø¨ÛŒØ´ØªØ± Ø§Ø² Ù‚ÛŒÙ…Øª Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù‡Ø²ÛŒÙ†Ù‡
                        finalPrice = unitCost * (1 + (desiredProfit + 20) / 100);
                        calculatedMargin = desiredProfit + 20;
                        break;
                    case 'competitive':
                        // Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ - ØªÙ†Ø¸ÛŒÙ… Ø¨Ø±Ø§Ø³Ø§Ø³ Ø³Ø·Ø­ Ø±Ù‚Ø§Ø¨Øª
                        let competitiveMultiplier = 1;
                        switch(competitionLevel) {
                            case 'high': competitiveMultiplier = 0.9; break; // Û±Û°Ùª Ú©Ù…ØªØ±
                            case 'medium': competitiveMultiplier = 1.0; break; // Ù‡Ù…Ø§Ù†
                            case 'low': competitiveMultiplier = 1.2; break; // Û²Û°Ùª Ø¨ÛŒØ´ØªØ±
                        }
                        finalPrice = unitCost * (1 + desiredProfit / 100) * competitiveMultiplier;
                        calculatedMargin = ((finalPrice - unitCost) / unitCost) * 100;
                        break;
                    default: // cost-plus
                        finalPrice = unitCost * (1 + desiredProfit / 100);
                }
                
                // ØªÙ†Ø¸ÛŒÙ… Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø±Ø§Ø³Ø§Ø³ Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯ Ù‡Ø¯Ù
                switch(targetMargin) {
                    case 'aggressive':
                        finalPrice *= 0.9; // Û±Û°Ùª Ú©Ø§Ù‡Ø´ Ø¨Ø±Ø§ÛŒ Ø±Ù‚Ø§Ø¨Øª
                        break;
                    case 'premium':
                        finalPrice *= 1.15; // Û±ÛµÙª Ø§ÙØ²Ø§ÛŒØ´ Ø¨Ø±Ø§ÛŒ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù¾Ø±ÛŒÙ…ÛŒÙˆÙ…
                        break;
                }
                
                const totalProfit = (finalPrice - unitCost) * quantity;
                const profitMargin = ((finalPrice - unitCost) / unitCost) * 100;
                
                // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
                displayResults({
                    productName,
                    materialCost,
                    totalLaborCost,
                    totalOverheadCost,
                    totalVariableCost,
                    taxAmount,
                    totalCost,
                    unitCost,
                    finalPrice,
                    totalProfit,
                    profitMargin,
                    quantity,
                    laborDetails,
                    overheadDetails,
                    variableDetails,
                    pricingStrategy,
                    competitionLevel,
                    marketPrice
                });
                
                // Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­Ø§Ø³Ø¨Ø§Øª
                saveProductionRecord({
                    productName,
                    materialCost,
                    totalLaborCost,
                    totalOverheadCost,
                    totalVariableCost,
                    taxAmount,
                    totalCost,
                    unitCost,
                    finalPrice,
                    totalProfit,
                    profitMargin,
                    quantity,
                    pricingStrategy,
                    date: new Date().toLocaleDateString('fa-IR'),
                    timestamp: Date.now()
                });
                
                // ØªÙˆÙ„ÛŒØ¯ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
                generateAdvancedAnalysis({
                    unitCost,
                    finalPrice,
                    profitMargin,
                    marketPrice,
                    competitionLevel,
                    pricingStrategy,
                    totalCost,
                    quantity
                });
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
                createCharts({
                    materialCost,
                    totalLaborCost,
                    totalOverheadCost,
                    totalVariableCost,
                    taxAmount,
                    totalProfit
                });
                
                // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø®Ø´ Ù†ØªØ§ÛŒØ¬
                document.getElementById('production-result').style.display = 'block';
                
                // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ù†ØªØ§ÛŒØ¬
                document.getElementById('production-result').scrollIntoView({ 
                    behavior: 'smooth' 
                });
                
                showSuccessMessage('Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯');
                
            }, 1000);
        }

        function displayResults(data) {
            // Ù†Ù…Ø§ÛŒØ´ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§
            document.getElementById('result-material-cost').textContent = 
                data.materialCost.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            document.getElementById('result-labor-cost').textContent = 
                data.totalLaborCost.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            document.getElementById('result-overhead-cost').textContent = 
                data.totalOverheadCost.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            document.getElementById('result-variable-cost').textContent = 
                data.totalVariableCost.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            document.getElementById('result-tax-cost').textContent = 
                data.taxAmount.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            
            // Ù†Ù…Ø§ÛŒØ´ Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„ Ùˆ ÙˆØ§Ø­Ø¯
            document.querySelector('.cost-item:nth-last-child(2) .cost-value').textContent = 
                data.totalCost.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            document.getElementById('result-unit-cost').textContent = 
                Math.round(data.unitCost).toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            
            // Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª Ù†Ù‡Ø§ÛŒÛŒ
            document.getElementById('result-final-price').textContent = 
                Math.round(data.finalPrice).toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            
            // Ù†Ù…Ø§ÛŒØ´ Ø³ÙˆØ¯
            document.getElementById('result-total-profit').textContent = 
                Math.round(data.totalProfit).toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            document.getElementById('result-profit-margin').textContent = 
                Math.round(data.profitMargin) + '%';
            
            // ØªØ­Ù„ÛŒÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù‚ÛŒÙ…Øª
            if (data.marketPrice > 0) {
                const priceDiff = ((data.finalPrice - data.marketPrice) / data.marketPrice) * 100;
                let comparisonText = '';
                
                if (priceDiff > 10) {
                    comparisonText = `ğŸ’° Ù‚ÛŒÙ…Øª Ø´Ù…Ø§ ${Math.abs(priceDiff).toFixed(1)}% Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø§Ø³Øª`;
                } else if (priceDiff < -10) {
                    comparisonText = `ğŸ’ Ù‚ÛŒÙ…Øª Ø´Ù…Ø§ ${Math.abs(priceDiff).toFixed(1)}% Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø§Ø³Øª - Ù…Ø²ÛŒØª Ø±Ù‚Ø§Ø¨ØªÛŒ Ø¹Ø§Ù„ÛŒ!`;
                } else {
                    comparisonText = `âš–ï¸ Ù‚ÛŒÙ…Øª Ø´Ù…Ø§ Ø¯Ø± Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ù‚ÛŒÙ…Øª Ø¨Ø§Ø²Ø§Ø± Ø§Ø³Øª`;
                }
                
                document.getElementById('price-comparison').innerHTML = comparisonText;
            }
        }

        function generateAdvancedAnalysis(data) {
            let advice = '';
            
            // ØªØ­Ù„ÛŒÙ„ Ù‚ÛŒÙ…Øª
            if (data.finalPrice < data.unitCost * 1.1) {
                advice += '<p>âš ï¸ <strong>Ù‡Ø´Ø¯Ø§Ø±: Ù‚ÛŒÙ…Øª Ø´Ù…Ø§ Ù†Ø²Ø¯ÛŒÚ© Ø¨Ù‡ Ù†Ù‚Ø·Ù‡ Ø³Ø±Ø¨Ù‡â€ŒØ³Ø± Ø§Ø³Øª!</strong> Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯ Ø¨Ø³ÛŒØ§Ø± Ú©Ù… Ù…ÛŒâ€ŒØ¨Ø§Ø´Ø¯.</p>';
            }
            
            if (data.profitMargin > 50) {
                advice += '<p>ğŸ¯ <strong>Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯ Ø¹Ø§Ù„ÛŒ!</strong> Ø´Ù…Ø§ Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø³ÛŒØ§Ø± Ø®ÙˆØ¨ÛŒ Ø¯Ø± Ø¨Ø§Ø²Ø§Ø± Ø¯Ø§Ø±ÛŒØ¯.</p>';
            }
            
            // ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù…
            if (data.quantity > 1000) {
                advice += '<p>ğŸ“ˆ <strong>ØªÙˆÙ„ÛŒØ¯ Ø§Ù†Ø¨ÙˆÙ‡:</strong> Ø¨Ø§ Ø§ÛŒÙ† Ø­Ø¬Ù… ØªÙˆÙ„ÛŒØ¯ØŒ Ø§Ù…Ú©Ø§Ù† Ú©Ø§Ù‡Ø´ Ø¨ÛŒØ´ØªØ± Ù‡Ø²ÛŒÙ†Ù‡ ÙˆØ§Ø­Ø¯ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯.</p>';
            }
            
            // ØªØ­Ù„ÛŒÙ„ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ
            switch(data.pricingStrategy) {
                case 'market-based':
                    advice += '<p>ğŸª <strong>Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø¨Ø§Ø²Ø§Ø±:</strong> Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ</p>';
                    break;
                case 'value-based':
                    advice += '<p>ğŸ’ <strong>Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø§Ø±Ø²Ø´:</strong> Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù…Ù†Ø­ØµØ±Ø¨ÙØ±Ø¯</p>';
                    break;
                case 'competitive':
                    advice += '<p>âš”ï¸ <strong>Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø±Ù‚Ø§Ø¨ØªÛŒ:</strong> Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø±Ù‚Ø§Ø¨Øª Ø´Ø¯ÛŒØ¯</p>';
                    break;
                default:
                    advice += '<p>ğŸ§® <strong>Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ù‡Ø²ÛŒÙ†Ù‡:</strong> Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ú©Ø§Ø±</p>';
            }
            
            // ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨Øª
            switch(data.competitionLevel) {
                case 'high':
                    advice += '<p>ğŸ”¥ <strong>Ø±Ù‚Ø§Ø¨Øª Ø´Ø¯ÛŒØ¯:</strong> Ú©ÛŒÙÛŒØª Ùˆ Ø®Ø¯Ù…Ø§Øª Ù¾Ø³ Ø§Ø² ÙØ±ÙˆØ´ Ú©Ù„ÛŒØ¯ Ù…ÙˆÙÙ‚ÛŒØª Ø´Ù…Ø§Ø³Øª</p>';
                    break;
                case 'medium':
                    advice += '<p>âš–ï¸ <strong>Ø±Ù‚Ø§Ø¨Øª Ù…ØªÙˆØ³Ø·:</strong> ÙØ¶Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ÛŒ Ø¨Ø±Ø§ÛŒ Ø±Ø´Ø¯ Ùˆ ØªÙˆØ³Ø¹Ù‡</p>';
                    break;
                case 'low':
                    advice += '<p>ğŸš€ <strong>Ø±Ù‚Ø§Ø¨Øª Ú©Ù…:</strong> ÙØ±ØµØª Ø¹Ø§Ù„ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ³Ù„Ø· Ø¨Ø± Ø¨Ø§Ø²Ø§Ø±</p>';
                    break;
            }
            
            // Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
            advice += `
                <p><strong>ğŸ”§ Ø±Ø§Ù‡Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù‡Ø²ÛŒÙ†Ù‡:</strong></p>
                <ul style="margin-right: 25px; margin-top: 10px;">
                    <li>Ø¨Ø±Ø±Ø³ÛŒ ØªØ£Ù…ÛŒÙ†â€ŒÚ©Ù†Ù†Ø¯Ú¯Ø§Ù† Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡</li>
                    <li>Ø§ØªÙˆÙ…Ø§Ø³ÛŒÙˆÙ† ÙØ±Ø¢ÛŒÙ†Ø¯Ù‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ÛŒ</li>
                    <li>Ø¨Ø±ÙˆÙ†â€ŒØ³Ù¾Ø§Ø±ÛŒ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ ØºÛŒØ±Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</li>
                    <li>Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…ØµØ±Ù Ø§Ù†Ø±Ú˜ÛŒ Ùˆ Ù…Ù†Ø§Ø¨Ø¹</li>
                    <li>Ø¢Ù…ÙˆØ²Ø´ Ù†ÛŒØ±ÙˆÛŒ Ø§Ù†Ø³Ø§Ù†ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ø¨Ù‡Ø±Ù‡â€ŒÙˆØ±ÛŒ</li>
                </ul>
            `;
            
            document.getElementById('production-advice').innerHTML = advice;
            
            // ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ
            generateCompetitiveAnalysis(data);
        }

        function generateCompetitiveAnalysis(data) {
            let analysis = '';
            
            if (data.marketPrice > 0) {
                const pricePosition = data.finalPrice / data.marketPrice;
                
                if (pricePosition < 0.9) {
                    analysis = `
                        <p>ğŸ† <strong>Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ù‚Ø§Ø¨ØªÛŒ: Ù¾ÛŒØ´ØªØ§Ø² Ù‚ÛŒÙ…Øª</strong></p>
                        <p>Ù‚ÛŒÙ…Øª Ø´Ù…Ø§ ${Math.round((1 - pricePosition) * 100)}% Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø§Ø³Øª. Ø§ÛŒÙ† Ù…Ø²ÛŒØª Ø±Ù‚Ø§Ø¨ØªÛŒ Ù‚ÙˆÛŒâ€ŒØ§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>
                        <p>ğŸ’¡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: Ø§Ø² Ø§ÛŒÙ† Ù…ÙˆÙ‚Ø¹ÛŒØª Ø¨Ø±Ø§ÛŒ Ø¬Ø°Ø¨ Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¬Ø¯ÛŒØ¯ Ùˆ Ø§ÙØ²Ø§ÛŒØ´ Ø³Ù‡Ù… Ø¨Ø§Ø²Ø§Ø± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</p>
                    `;
                } else if (pricePosition <= 1.1) {
                    analysis = `
                        <p>âš–ï¸ <strong>Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ù‚Ø§Ø¨ØªÛŒ: Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§Ø²Ø§Ø±</strong></p>
                        <p>Ù‚ÛŒÙ…Øª Ø´Ù…Ø§ Ø¯Ø± Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ù‚ÛŒÙ…Øª Ø¨Ø§Ø²Ø§Ø± Ø§Ø³Øª. Ø±Ù‚Ø§Ø¨Øª Ø¨Ø±Ø§Ø³Ø§Ø³ Ú©ÛŒÙÛŒØª Ùˆ Ø®Ø¯Ù…Ø§Øª Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯.</p>
                        <p>ğŸ’¡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: Ø¨Ø± Ø¨Ù‡Ø¨ÙˆØ¯ Ú©ÛŒÙÛŒØª Ùˆ Ø®Ø¯Ù…Ø§Øª Ù¾Ø³ Ø§Ø² ÙØ±ÙˆØ´ ØªÙ…Ø±Ú©Ø² Ú©Ù†ÛŒØ¯.</p>
                    `;
                } else {
                    analysis = `
                        <p>ğŸ’ <strong>Ù…ÙˆÙ‚Ø¹ÛŒØª Ø±Ù‚Ø§Ø¨ØªÛŒ: Ù¾Ø±ÛŒÙ…ÛŒÙˆÙ…</strong></p>
                        <p>Ù‚ÛŒÙ…Øª Ø´Ù…Ø§ ${Math.round((pricePosition - 1) * 100)}% Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø§Ø³Øª. Ù…Ø´ØªØ±ÛŒØ§Ù† Ø¨Ø±Ø§ÛŒ Ú©ÛŒÙÛŒØª Ø¨Ø§Ù„Ø§ØªØ± Ø­Ø§Ø¶Ø± Ø¨Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨ÛŒØ´ØªØ± Ù‡Ø³ØªÙ†Ø¯.</p>
                        <p>ğŸ’¡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: Ø¨Ø± Ø§Ø±Ø²Ø´â€ŒØ§ÙØ²ÙˆØ¯Ù‡ Ùˆ ØªØ¬Ø±Ø¨Ù‡ Ù…Ø´ØªØ±ÛŒ Ø¹Ø§Ù„ÛŒ ØªÙ…Ø±Ú©Ø² Ú©Ù†ÛŒØ¯.</p>
                    `;
                }
            } else {
                analysis = `
                    <p>ğŸ” <strong>ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ:</strong></p>
                    <p>Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø¯Ù‚ÛŒÙ‚â€ŒØªØ±ØŒ Ù‚ÛŒÙ…Øª Ø±Ù‚Ø¨Ø§ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</p>
                    <p>ğŸ’¡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯: ØªØ­Ù‚ÛŒÙ‚Ø§Øª Ø¨Ø§Ø²Ø§Ø± Ø¨Ø±Ø§ÛŒ ØªØ¹ÛŒÛŒÙ† Ù‚ÛŒÙ…Øª Ø¨Ù‡ÛŒÙ†Ù‡ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯.</p>
                `;
            }
            
            document.getElementById('competitive-analysis').innerHTML = analysis;
        }

        function createCharts(data) {
            // Ù†Ù…ÙˆØ¯Ø§Ø± ØªÙˆØ²ÛŒØ¹ Ù‡Ø²ÛŒÙ†Ù‡
            const costCtx = document.getElementById('costDistributionChart').getContext('2d');
            
            if (costDistributionChart) {
                costDistributionChart.destroy();
            }
            
            costDistributionChart = new Chart(costCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡', 'Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±', 'Ø³Ø±Ø¨Ø§Ø±', 'Ù…ØªØºÛŒØ±', 'Ù…Ø§Ù„ÛŒØ§Øª'],
                    datasets: [{
                        data: [
                            data.materialCost,
                            data.totalLaborCost,
                            data.totalOverheadCost,
                            data.totalVariableCost,
                            data.taxAmount
                        ],
                        backgroundColor: [
                            '#00b894',
                            '#0984e3',
                            '#fdcb6e',
                            '#fd79a8',
                            '#a29bfe'
                        ],
                        borderWidth: 3,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'left',
                            rtl: true,
                            labels: {
                                font: {
                                    family: 'Vazir, Tahoma',
                                    size: 12
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            rtl: true,
                            bodyFont: {
                                family: 'Vazir, Tahoma'
                            },
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed;
                                    const total = data.materialCost + data.totalLaborCost + 
                                                 data.totalOverheadCost + data.totalVariableCost + 
                                                 data.taxAmount;
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                    return `${value.toLocaleString()} ØªÙˆÙ…Ø§Ù† (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Ù†Ù…ÙˆØ¯Ø§Ø± ØªØ­Ù„ÛŒÙ„ Ø³ÙˆØ¯
            const profitCtx = document.getElementById('profitAnalysisChart').getContext('2d');
            
            if (profitAnalysisChart) {
                profitAnalysisChart.destroy();
            }
            
            const totalCost = data.materialCost + data.totalLaborCost + 
                            data.totalOverheadCost + data.totalVariableCost + 
                            data.taxAmount;
            
            profitAnalysisChart = new Chart(profitCtx, {
                type: 'bar',
                data: {
                    labels: ['Ù‡Ø²ÛŒÙ†Ù‡ Ú©Ù„', 'Ø³ÙˆØ¯'],
                    datasets: [{
                        label: 'ØªÙˆØ²ÛŒØ¹ Ø¯Ø±Ø¢Ù…Ø¯',
                        data: [totalCost, data.totalProfit],
                        backgroundColor: ['#e74c3c', '#27ae60'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            rtl: true,
                            bodyFont: {
                                family: 'Vazir, Tahoma'
                            },
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y;
                                    const total = totalCost + data.totalProfit;
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                    return `${value.toLocaleString()} ØªÙˆÙ…Ø§Ù† (${percentage}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Vazir, Tahoma'
                                },
                                callback: function(value) {
                                    return (value / 1000000).toFixed(0) + 'M';
                                }
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Vazir, Tahoma',
                                    size: 14,
                                    weight: 'bold'
                                }
                            }
                        }
                    }
                }
            });
        }

        function saveProductionRecord(record) {
            productionData.unshift(record);
            
            try {
                localStorage.setItem('advancedProductionData', JSON.stringify(productionData));
            } catch(e) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§:', e);
            }
            
            renderProductionHistory();
        }

        function renderProductionHistory() {
            const container = document.getElementById('production-history');
            container.innerHTML = '';
            
            if (productionData.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ğŸ“Š</div>
                        <p>Ù‡Ù†ÙˆØ² Ù‡ÛŒÚ† Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ ÙØ±Ù… Ø¨Ø§Ù„Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯</p>
                    </div>
                `;
                return;
            }
            
            productionData.slice(0, 10).forEach(record => {
                const historyEl = document.createElement('div');
                historyEl.className = 'history-item';
                historyEl.innerHTML = `
                    <div class="history-header">
                        <div class="history-product">${record.productName}</div>
                        <div class="history-date">${record.date}</div>
                    </div>
                    <div class="history-details">
                        <div class="history-detail">
                            <span>ØªØ¹Ø¯Ø§Ø¯:</span>
                            <span>${record.quantity.toLocaleString()}</span>
                        </div>
                        <div class="history-detail">
                            <span>Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´:</span>
                            <span>${Math.round(record.finalPrice).toLocaleString()} ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="history-detail">
                            <span>Ø³ÙˆØ¯ Ú©Ù„:</span>
                            <span style="color: var(--success); font-weight: 800;">${Math.round(record.totalProfit).toLocaleString()} ØªÙˆÙ…Ø§Ù†</span>
                        </div>
                        <div class="history-detail">
                            <span>Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯:</span>
                            <span>${Math.round(record.profitMargin)}%</span>
                        </div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.85em; color: #636e72;">
                        Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ: ${record.pricingStrategy}
                    </div>
                `;
                container.appendChild(historyEl);
            });
        }

        // ============================================
        // ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø§Ø¶Ø§ÙÛŒ
        // ============================================

        function generateFullReport() {
            if (productionData.length === 0) {
                showErrorMessage('Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ú¯Ø²Ø§Ø±Ø´â€ŒÚ¯ÛŒØ±ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                return;
            }
            
            const button = event.target;
            addLoading(button);
            
            setTimeout(() => {
                // Ø§ÛŒØ¬Ø§Ø¯ Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø§Ù…Ø¹
                const report = {
                    title: 'Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø§Ù…Ø¹ ØªÙˆÙ„ÛŒØ¯',
                    generatedAt: new Date().toLocaleString('fa-IR'),
                    totalRecords: productionData.length,
                    totalRevenue: productionData.reduce((sum, r) => sum + (r.finalPrice * r.quantity), 0),
                    totalProfit: productionData.reduce((sum, r) => sum + r.totalProfit, 0),
                    averageMargin: productionData.reduce((sum, r) => sum + r.profitMargin, 0) / productionData.length,
                    recentRecords: productionData.slice(0, 5)
                };
                
                // Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´
                alert(`Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø§Ù…Ø¹ ØªÙˆÙ„ÛŒØ¯:\n\n` +
                      `ØªØ¹Ø¯Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§: ${report.totalRecords}\n` +
                      `Ø¯Ø±Ø¢Ù…Ø¯ Ú©Ù„: ${report.totalRevenue.toLocaleString()} ØªÙˆÙ…Ø§Ù†\n` +
                      `Ø³ÙˆØ¯ Ú©Ù„: ${report.totalProfit.toLocaleString()} ØªÙˆÙ…Ø§Ù†\n` +
                      `Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯: ${report.averageMargin.toFixed(1)}%\n\n` +
                      `Ú¯Ø²Ø§Ø±Ø´ Ø¯Ø± ØªØ§Ø±ÛŒØ® ${report.generatedAt} ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù‡ Ø§Ø³Øª.`);
                
                showSuccessMessage('Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø§Ù…Ø¹ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯');
            }, 1500);
        }

        function showComparativeAnalysis() {
            if (productionData.length < 2) {
                showErrorMessage('Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ Ø­Ø¯Ø§Ù‚Ù„ Û² Ø±Ú©ÙˆØ±Ø¯ Ù„Ø§Ø²Ù… Ø§Ø³Øª');
                return;
            }
            
            const button = event.target;
            addLoading(button);
            
            setTimeout(() => {
                const recent = productionData.slice(0, 5);
                let analysis = 'ğŸ“Š ØªØ­Ù„ÛŒÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ Ûµ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ø®ÛŒØ±:\n\n';
                
                recent.forEach((record, index) => {
                    analysis += `${index + 1}. ${record.productName}:\n`;
                    analysis += `   Ù‚ÛŒÙ…Øª: ${Math.round(record.finalPrice).toLocaleString()} ØªÙˆÙ…Ø§Ù†\n`;
                    analysis += `   Ø³ÙˆØ¯: ${Math.round(record.totalProfit).toLocaleString()} ØªÙˆÙ…Ø§Ù†\n`;
                    analysis += `   Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯: ${Math.round(record.profitMargin)}%\n`;
                    analysis += `   ØªØ¹Ø¯Ø§Ø¯: ${record.quantity.toLocaleString()}\n\n`;
                });
                
                const avgProfit = recent.reduce((sum, r) => sum + r.profitMargin, 0) / recent.length;
                const avgPrice = recent.reduce((sum, r) => sum + r.finalPrice, 0) / recent.length;
                
                analysis += `ğŸ“ˆ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†â€ŒÙ‡Ø§:\n`;
                analysis += `Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯: ${avgProfit.toFixed(1)}%\n`;
                analysis += `Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´: ${Math.round(avgPrice).toLocaleString()} ØªÙˆÙ…Ø§Ù†`;
                
                alert(analysis);
                
                showSuccessMessage('ØªØ­Ù„ÛŒÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯');
            }, 1500);
        }

        function exportToExcel() {
            if (productionData.length === 0) {
                showErrorMessage('Ù‡ÛŒÚ† Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø®Ø±ÙˆØ¬ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯');
                return;
            }
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ø³Ø§Ø®ØªØ§Ø± CSV
            let csv = 'Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„,ØªØ¹Ø¯Ø§Ø¯,Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´,Ù‡Ø²ÛŒÙ†Ù‡ ÙˆØ§Ø­Ø¯,Ø³ÙˆØ¯ Ú©Ù„,Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯,ØªØ§Ø±ÛŒØ®\n';
            
            productionData.forEach(record => {
                csv += `${record.productName},${record.quantity},${record.finalPrice},${record.unitCost},${record.totalProfit},${record.profitMargin}%,${record.date}\n`;
            });
            
            // Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„ Ùˆ Ø¯Ø§Ù†Ù„ÙˆØ¯
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `Ú¯Ø²Ø§Ø±Ø´_ØªÙˆÙ„ÛŒØ¯_${new Date().toLocaleDateString('fa-IR')}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showSuccessMessage('Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯');
        }

        function clearAllData() {
            if (!confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ùˆ Ø§Ù„Ú¯ÙˆÙ‡Ø§ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ Ø§ÛŒÙ† Ø¹Ù…Ù„ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø³Øª.')) {
                return;
            }
            
            const button = event.target;
            addLoading(button);
            
            setTimeout(() => {
                // Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                productionData = [];
                patterns = defaultPatterns;
                currentPattern = null;
                
                // Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ localStorage
                localStorage.removeItem('advancedProductionData');
                localStorage.removeItem('productionPatterns');
                localStorage.removeItem('lastPatternId');
                
                // Ù¾Ø§Ú©â€ŒØ³Ø§Ø²ÛŒ ÙØ±Ù…
                document.getElementById('product-name').value = '';
                document.getElementById('material-cost').value = '';
                document.getElementById('production-quantity').value = '';
                document.getElementById('labor-costs').innerHTML = '';
                document.getElementById('overhead-costs').innerHTML = '';
                document.getElementById('variable-costs').innerHTML = '';
                
                // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù†ØªØ§ÛŒØ¬
                document.getElementById('production-result').style.display = 'none';
                
                // Ø¨Ø§Ø²Ø³Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
                initializeCostFields();
                renderPatternsList();
                renderProductionHistory();
                
                showSuccessMessage('ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯Ù†Ø¯ Ùˆ Ø³ÛŒØ³ØªÙ… Ø¨Ù‡ Ø­Ø§Ù„Øª Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø§Ø²Ú¯Ø´Øª');
            }, 1000);
        }

        // ============================================
        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ
        // ============================================

        function addLoading(element) {
            element.classList.add('loading');
            setTimeout(() => {
                element.classList.remove('loading');
            }, 1500);
        }

        function showSuccessMessage(message) {
            const existingMessage = document.querySelector('.success-message');
            if (existingMessage) { existingMessage.remove(); }
            
            const successMessage = document.createElement('div');
            successMessage.className = 'success-message';
            successMessage.innerHTML = `âœ… ${message}`;
            
            const content = document.querySelector('.main-content');
            content.insertBefore(successMessage, content.firstChild);
            
            setTimeout(() => { 
                if (successMessage.parentElement) { 
                    successMessage.remove(); 
                } 
            }, 4000);
        }

        function showErrorMessage(message) {
            const errorMessage = document.createElement('div');
            errorMessage.className = 'success-message';
            errorMessage.style.background = 'linear-gradient(135deg, var(--danger), #c0392b)';
            errorMessage.innerHTML = `âŒ ${message}`;
            
            const content = document.querySelector('.main-content');
            content.insertBefore(errorMessage, content.firstChild);
            
            setTimeout(() => { 
                if (errorMessage.parentElement) { 
                    errorMessage.remove(); 
                } 
            }, 4000);
        }

        // ============================================
        // Û³Û° ÙˆÛŒÚ˜Ú¯ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡:
        // ============================================
        /*
        1. Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª ÛµÛ° Ø§Ù„Ú¯ÙˆÛŒ ØªÙˆÙ„ÛŒØ¯
        2. ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø§ AI
        3. Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ù‚ÛŒÙ…Øª Ø¨Ø§Ø²Ø§Ø±
        4. Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡ ØªØ£Ù…ÛŒÙ†
        5. Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¨Ù„Ø§Ø¯Ø±Ù†Ú¯
        6. Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ÛŒ ØªØ¹Ø§Ù…Ù„ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        7. ØªØ­Ù„ÛŒÙ„ Ø±Ù‚Ø§Ø¨ØªÛŒ
        8. Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒâ€ŒÙ‡Ø§ÛŒ Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ø®ØªÙ„Ù
        9. Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø§Ù„ÛŒØ§Øª Ùˆ Ø¹ÙˆØ§Ø±Ø¶
        10. ØªØ­Ù„ÛŒÙ„ Ù†Ù‚Ø·Ù‡ Ø³Ø±Ø¨Ù‡â€ŒØ³Ø±
        11. Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù‡Ø²ÛŒÙ†Ù‡ Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±
        12. Ù…Ø¯ÛŒØ±ÛŒØª Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø³Ø±Ø¨Ø§Ø±
        13. ØªØ­Ù„ÛŒÙ„ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªØºÛŒØ±
        14. Ú¯Ø²Ø§Ø±Ø´â€ŒÚ¯ÛŒØ±ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        15. Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„
        16. ØªØ­Ù„ÛŒÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ ØªØ§Ø±ÛŒØ®ÛŒ
        17. Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ
        18. ØªØ­Ù„ÛŒÙ„ Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯
        19. Ù…ÙˆÙ‚Ø¹ÛŒØªâ€ŒØ³Ù†Ø¬ÛŒ Ø¨Ø§Ø²Ø§Ø±
        20. ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… ØªÙˆÙ„ÛŒØ¯ Ø¨Ù‡ÛŒÙ†Ù‡
        21. Ø³ÛŒØ³ØªÙ… Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ
        22. Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        23. Ø·Ø±Ø§Ø­ÛŒ ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§
        24. Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ù…ÙˆØ¨Ø§ÛŒÙ„ Ùˆ ØªØ¨Ù„Øª
        25. Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ
        26. Ø³ÛŒØ³ØªÙ… Ø§Ø·Ù„Ø§Ø¹â€ŒØ±Ø³Ø§Ù†ÛŒ
        27. Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        28. Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±
        29. Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± ØªØ§Ø±ÛŒØ®Ú†Ù‡
        30. ØªØ­Ù„ÛŒÙ„ Ø±ÛŒØ³Ú© Ùˆ Ø¨Ø§Ø²Ø¯Ù‡
        */
    </script>
</body>
</html>